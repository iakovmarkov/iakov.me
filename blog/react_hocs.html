<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><title>Higher-Order Components in React - iakov.me</title><link rel="icon" type="image/x-icon" href="/favicon.ico"/><meta name="description" content="This post will talk about a key conecpt in functional programming, and demonstrate it on a more-or-less practical example. 
"/><meta property="og:title" content="Higher-Order Components in React - iakov.me"/><meta property="og:url" content="https://iakov.me/"/><meta property="og:image" content="https://iakov.me/profile/avatar.jpg"/><meta property="og:description" content="This post will talk about a key conecpt in functional programming, and demonstrate it on a more-or-less practical example. 
"/><meta itemProp="name" content="Higher-Order Components in React - iakov.me"/><meta itemProp="description" content="This post will talk about a key conecpt in functional programming, and demonstrate it on a more-or-less practical example. 
"/><meta itemProp="image" content="https://iakov.me/profile/avatar.jpg"/><link href="/fonts/PTSerif-Regular.ttf" rel="preload" as="font" type="font/ttf" crossorigin="true"/><link href="/fonts/PTSerif-Bold.ttf" rel="preload" as="font" type="font/ttf" crossorigin="true"/><link href="/fonts/PTSerif-RegularItalic.ttf" rel="preload" as="font" type="font/ttf" crossorigin="true"/><link href="/fonts/PTSerif-BoldItalic.ttf" rel="preload" as="font" type="font/ttf" crossorigin="true"/><link href="/fonts/Poppins-Regular.ttf" rel="preload" as="font" type="font/ttf" crossorigin="true"/><link href="/fonts/Poppins-SemiBold.ttf" rel="preload" as="font" type="font/ttf" crossorigin="true"/><link href="/fonts/Poppins-SemiBoldItalic.ttf" rel="preload" as="font" type="font/ttf" crossorigin="true"/><link href="/fonts/Poppins-BlackItalic.ttf" rel="preload" as="font" type="font/ttf" crossorigin="true"/><meta name="next-head-count" content="20"/><link rel="preload" href="/_next/static/css/5c03777018ba97088b1a.css" as="style"/><link rel="stylesheet" href="/_next/static/css/5c03777018ba97088b1a.css"/><link rel="preload" href="/_next/static/XDHmRbjTjbrhjheiSpBR7/pages/_app.js" as="script"/><link rel="preload" href="/_next/static/XDHmRbjTjbrhjheiSpBR7/pages/blog/%5Bslug%5D.js" as="script"/><link rel="preload" href="/_next/static/runtime/webpack-099a652a84207c43d340.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.619a4f70c1d4d3a29cbc.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons.dd1d4337766320e3f3cd.js" as="script"/><link rel="preload" href="/_next/static/chunks/7823f1fa03b035db0019697d5756f95c6b249c6a.06fc960a10b812484c42.js" as="script"/><link rel="preload" href="/_next/static/runtime/main-4e8887e0577ac493b676.js" as="script"/><link rel="preload" href="/_next/static/chunks/9f96d65d.1337245caf768c94bbd9.js" as="script"/><link rel="preload" href="/_next/static/chunks/0e520e4cf0d15bb5df764f4c7bd3ed536b161189.4702076dd3fe1fe85372.js" as="script"/><link rel="preload" href="/_next/static/chunks/40dad8a098b120e67f2f427133882ae3c299354f.ace18cfed87d240a24a6.js" as="script"/><link rel="preload" href="/_next/static/chunks/11b950283c14f01b3946ede4125cdb590c919828.02b326bf6ced6da2b901.js" as="script"/><style type="text/css" id="server-side-styles">.content-0-2-26 {}
.content-d0-0-2-27 {}
.content-d0-0-2-27 p {
  margin: 8px 0 8px;
  vertical-align: baseline;
}
.content-d0-0-2-27 a {
  text-decoration: underline !important;
}
.content-d0-0-2-27 blockquote {
  margin: 8px 0 8px;
  padding: 0 0 0 18px;
  border-left: 4px solid #eeeeee;
}
.content-d0-0-2-27 h1, .content-d0-0-2-27 h2, .content-d0-0-2-27 h3, .content-d0-0-2-27 h4, .content-d0-0-2-27 h5, .content-d0-0-2-27 h6 {
  margin: 18px 0 8px;
}
.content-d0-0-2-27 hr {
  color: #eeeeee;
  margin: 4px 0;
}
.content-d0-0-2-27 ul, .content-d0-0-2-27 ol {
  margin: 4px 0 4px;
  padding: 0 0 0 4px;
  list-style: none;
  counter-reset: list;
}
.content-d0-0-2-27 li {
  position: relative;
  padding-left: 1.2em;
  counter-increment: list;
}
.content-d0-0-2-27 li::before {
  left: 0;
  width: 1em;
  position: absolute;
  text-align: center;
}
.content-d0-0-2-27 ul li::before {
  content: &quot;‚Ä∫&quot;;
}
.content-d0-0-2-27 ol li::before {
  content: counter(list)&quot;.&quot;;
}
.content-d0-0-2-27 li.checked::before {
  content: &quot;üóπ&quot;;
}
.content-d0-0-2-27 li.unchecked::before {
  content: &quot;‚òê&quot;;
}
.content-d0-0-2-27 table {
  width: 100%;
  margin: 8px 0;
  max-width: 100%;
  border-collapse: collapse;
}
.content-d0-0-2-27 th {
  padding: 4px 8px;
  text-align: left;
  font-family: Poppins, sans-serif;
  font-weight: 600;
}
.content-d0-0-2-27 td {
  margin: 0;
  padding: 4px 8px;
}
.content-d0-0-2-27 tr {
  border-bottom: 1px solid #eeeeee;
}
.content-d0-0-2-27 a:hover, .content-d0-0-2-27 a:active {
  color: rgb(239, 72, 0);
}
.container-0-2-3 {}
.navContainer-0-2-4 {
  width: 100%;
  display: flex;
  justify-content: center;
}
.nav-0-2-5 {}
.contentContainer-0-2-6 {}
.container-d0-0-2-7 {
  display: flex;
  background: #FFFFFF;
  min-height: 100%;
  align-items: center;
  flex-direction: column;
}
.nav-d1-0-2-8 {
  width: 100%;
  max-width: 760px;
  border-bottom: 1px solid #eeeeee;
}
.contentContainer-d2-0-2-9 {
  width: 100%;
  padding: 18px 18px;
  font-size: 16px;
  max-width: 760px;
}
.contentContainer-d2-0-2-9 h1 {
  font-size: 24px;
  font-family: Poppins, sans-serif;
  font-weight: 600;
}
.contentContainer-d2-0-2-9 h2 {
  font-size: 22.4px;
  font-family: Poppins, sans-serif;
  font-weight: 600;
}
.contentContainer-d2-0-2-9 h3 {
  font-size: 20.8px;
  font-family: Poppins, sans-serif;
  font-weight: 600;
}
.contentContainer-d2-0-2-9 h4 {
  font-size: 19.2px;
  font-family: Poppins, sans-serif;
  font-weight: 600;
}
.contentContainer-d2-0-2-9 h5 {
  font-size: 17.6px;
  font-family: Poppins, sans-serif;
  font-weight: 600;
}
.contentContainer-d2-0-2-9 h6 {
  font-size: 16px;
  font-family: Poppins, sans-serif;
  font-weight: 600;
}
.tag-0-2-34 {}
.tag-d0-0-2-35 {
  border: 1px solid #eeeeee;
  margin: 1px 4px 1px 0;
  display: inline-block;
  padding: 0 4px;
  font-style: normal;
  font-family: Poppins, sans-serif;
  font-weight: 400;
}
.tag-d1-0-2-36 {
  border: 1px solid #eeeeee;
  margin: 1px 4px 1px 0;
  display: inline-block;
  padding: 0 4px;
  font-style: normal;
  font-family: Poppins, sans-serif;
  font-weight: 400;
}
.tag-d2-0-2-37 {
  border: 1px solid #eeeeee;
  margin: 1px 4px 1px 0;
  display: inline-block;
  padding: 0 4px;
  font-style: normal;
  font-family: Poppins, sans-serif;
  font-weight: 400;
}
.tag-d3-0-2-38 {
  border: 1px solid #eeeeee;
  margin: 1px 4px 1px 0;
  display: inline-block;
  padding: 0 4px;
  font-style: normal;
  font-family: Poppins, sans-serif;
  font-weight: 400;
}
.tag-d4-0-2-39 {
  border: 1px solid #eeeeee;
  margin: 1px 4px 1px 0;
  display: inline-block;
  padding: 0 4px;
  font-style: normal;
  font-family: Poppins, sans-serif;
  font-weight: 400;
}
.container-0-2-20 {}
.title-0-2-21 {
  flex: 1;
  font-size: 24px;
}
.date-0-2-22 {}
.container-d0-0-2-23 {
  margin: 0 0 4px 0;
  display: flex;
  padding: 4px 0;
  border-bottom: 1px solid #eeeeee;
  justify-content: space-between;
}
@media only screen and (max-width: 768px) {
  .container-d0-0-2-23 {
    display: block;
  }
}
  .title-d1-0-2-24 {
    margin: 4px 0px;
  }
  .date-d2-0-2-25 {
    color: #777777;
    display: flex;
    font-size: 0.9em;
    align-items: center;
    font-family: Poppins, sans-serif;
    flex-direction: row;
  }
@media only screen and (max-width: 768px) {
  .date-d2-0-2-25 {
    display: none;
  }
}
  .readMoreLink-0-2-16 {
    display: inline-block;
    font-size: 0.8em;
  }
  .readMoreLink-0-2-16:hover, .readMoreLink-0-2-16:active {
    color: #FFFFFF;
    background: #000000;
  }
  .postBody-0-2-17 {  }
  .postBody-0-2-17 p:first-of-type::first-letter {
    float: left;
    font-size: 48px;
    line-height: 30px;
    vertical-align: baseline;
  }
  .readMoreLink-d0-0-2-18 {
    font-family: Poppins, sans-serif;
    margin: 4px 0;
    padding: 4px 8px;
    border: 2px solid #000000;
    color: #000000;
    background: #FFFFFF;
  }
  .postBody-d1-0-2-19 {  }
  .postBody-d1-0-2-19 p:first-of-type::first-letter {
    padding: 8px 4px 0 0px;
  }
  .container-0-2-1 {  }
  .container-d0-0-2-2 {
    margin: 18px 0 0;
    padding: 0 0 18px;
  }
  .nav-0-2-10 {
    font-style: italic;
    align-items: start;
    font-weight: 600;
    text-transform: uppercase;
  }
  .list-0-2-11 {
    margin: 0;
    display: flex;
    padding: 0;
    list-style: none;
    flex-direction: row;
    justify-content: center;
  }
  .listItem-0-2-12 {  }
  .link-0-2-13 {  }
  .listItem-d0-0-2-14 {
    font-family: Poppins, sans-serif;
  }
  .link-d1-0-2-15 {
    display: block;
    padding: 18px 36px;
    border-bottom: 4px solid transparent;
  }
@media only screen and (max-width: 768px) {
  .link-d1-0-2-15 {
    padding: 8px 16px;
  }
}
  .link-d1-0-2-15.isActive {
    border-bottom-color: #eeeeee;
  }
  .link-d1-0-2-15:hover, .link-d1-0-2-15:active {
    color: rgb(239, 72, 0);
    border-bottom-color: rgb(239, 72, 0);
  }
  .container-0-2-28 {  }
  .key-0-2-29 {
    text-transform: capitalize;
  }
  .content-0-2-30 {  }
  .tags-0-2-31 {
    flex-wrap: wrap;
  }
  .container-d0-0-2-32 {
    margin: 18px 0px;
    display: flex;
    padding: 18px 0px;
    border-top: 1px solid #eeeeee;
    align-items: center;
  }
@media only screen and (max-width: 768px) {
  .container-d0-0-2-32 {
    display: block;
  }
}
  .content-d1-0-2-33 {
    color: #777777;
    margin: 4px 8px 4px 0;
    display: flex;
    font-size: 0.8em;
    word-break: keep-all;
    align-items: center;
    font-family: Poppins, sans-serif;
    white-space: nowrap;
    border-right: 1px solid #eeeeee;
    padding-right: 8px;
  }
  .content-d1-0-2-33:last-child {
    border-right: none;
  }
@media only screen and (max-width: 768px) {
  .content-d1-0-2-33 {
    width: 100%;
    border-right: none;
  }
}</style></head><body><div id="__next"><div class="container-0-2-3 container-d0-0-2-7"><div class="navContainer-0-2-4"><div class="nav-0-2-5 nav-d1-0-2-8"><nav class="nav-0-2-10"><ul class="list-0-2-11"><li class="listItem-0-2-12 listItem-d0-0-2-14"><a href="/" class="link-0-2-13 link-d1-0-2-15 false">Home</a></li><li class="listItem-0-2-12 listItem-d0-0-2-14"><a href="/about" class="link-0-2-13 link-d1-0-2-15 false">About</a></li><li class="listItem-0-2-12 listItem-d0-0-2-14"><a href="/blog" class="link-0-2-13 link-d1-0-2-15 isActive">Blog</a></li><li class="listItem-0-2-12 listItem-d0-0-2-14"><a href="mailto:markov@iakov.me" class="link-0-2-13 link-d1-0-2-15 false">Contact</a></li></ul></nav></div></div><div class="contentContainer-0-2-6 contentContainer-d2-0-2-9"><div class="container-0-2-1 container-d0-0-2-2"><article><div class="container-0-2-20 container-d0-0-2-23"><h1 class="title-0-2-21 title-d1-0-2-24">Higher-Order Components in React</h1><div class="date-0-2-22 date-d2-0-2-25">21.10.2017</div></div><div class="postBody-0-2-17 postBody-d1-0-2-19"><div class="content-0-2-26 content-d0-0-2-27"><h2>Intro</h2><p>Most React developers are using object-oriented approach to React components. They create classes that tightly couple business logic with JSX code. By using functional components and composition, you can split the code very much like MVC pattern suggests. This will ensure a greater degree of separation of concerns in your code, and will make your components easier to reuse and refactor. Moreover, you can combine multiple higher-order functions into one, reusable function. This is very useful for functionality that you repeat in multiple places, like working with a REST API or validating form input.</p><p>A small, but nevertheless cool thing about separating view code from business logic is that you, as a developer, can replace React with any other similar view library. The practical application of this is very limited, but I&#x27;m going to show you how it&#x27;s done in the very end of this blog post.</p><p>If you&#x27;re not familiar with functional programming, I&#x27;d recommend taking a look at <a href="/blog/functional-react">Funcitonal Programming in React</a>. </p><h2>Functional composition</h2><p>Functional composition is a way to use simple functions together to get a complex behaviour. Consider this example:</p><pre style="color:#c5c8c6;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Inconsolata, Monaco, Consolas, &#x27;Courier New&#x27;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em;background:#1d1f21"><code style="color:#c5c8c6;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Inconsolata, Monaco, Consolas, &#x27;Courier New&#x27;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;float:left;padding-right:10px"><span class="react-syntax-highlighter-line-number">1
</span><span class="react-syntax-highlighter-line-number">2
</span><span class="react-syntax-highlighter-line-number">3
</span><span class="react-syntax-highlighter-line-number">4
</span><span class="react-syntax-highlighter-line-number">5
</span><span class="react-syntax-highlighter-line-number">6
</span><span class="react-syntax-highlighter-line-number">7
</span><span class="react-syntax-highlighter-line-number">8
</span><span class="react-syntax-highlighter-line-number">9
</span></code><code style="color:#c5c8c6;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Inconsolata, Monaco, Consolas, &#x27;Courier New&#x27;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none">const getCartTotal = (prices) =&gt; {
  const pricesWithTax = prices.map(p =&gt; p * 1.22)
  const priceTotal = pricesWithTax.reduce((p, acc) =&gt; acc += p, 0)
  const priceTotalRounded = Number(priceTotal.toFixed(2))

  return priceTotalRounded
}

getCartTotal([4, 8, 1]) // 15.86</code></pre><p>This function works well to get total price for every item in cart. But if I need to implement a function that will calculate the cart total without tax, or a price of each item with tax, I&#x27;ll be tempted to copy-and-paste the code from <code>getCartTotal</code> function. </p><p>A better idea is to refactor <code>getCartTotal</code> into few functions that adhere to Single Responsibility Principle and use them together. This is how it can look like:</p><pre style="color:#c5c8c6;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Inconsolata, Monaco, Consolas, &#x27;Courier New&#x27;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em;background:#1d1f21"><code style="color:#c5c8c6;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Inconsolata, Monaco, Consolas, &#x27;Courier New&#x27;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;float:left;padding-right:10px"><span class="react-syntax-highlighter-line-number">1
</span><span class="react-syntax-highlighter-line-number">2
</span><span class="react-syntax-highlighter-line-number">3
</span><span class="react-syntax-highlighter-line-number">4
</span><span class="react-syntax-highlighter-line-number">5
</span><span class="react-syntax-highlighter-line-number">6
</span><span class="react-syntax-highlighter-line-number">7
</span><span class="react-syntax-highlighter-line-number">8
</span></code><code style="color:#c5c8c6;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Inconsolata, Monaco, Consolas, &#x27;Courier New&#x27;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none">const map = (fn) =&gt; (value) =&gt; value.map(fn)
const addTax = (value) =&gt; value * 1.22
const sum = (values) =&gt; values.reduce((acc, value) =&gt; acc += value, 0)
const round = (pos = 2) =&gt; (value) =&gt; Number(value.toFixed(pos))

const getCartTotal = (prices) =&gt; round(2)(sum(map(addTax)(prices)))

getCartTotal([4, 8, 1]) // 15.86</code></pre><p>The result is the same, and the new <code>addTax</code>, <code>sum</code> and <code>round</code> functions look pretty generic and reusable. The only thing that is objectively bad here is <code>round(2)(sum(map(addTax)(prices)))</code>. It&#x27;s just hard to read.</p><p>When JS is executing this line, it runs the innermost function, and passes it&#x27;s return value to another function. We can write a function that will do exactly this, but with a more readable synthax:</p><pre style="color:#c5c8c6;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Inconsolata, Monaco, Consolas, &#x27;Courier New&#x27;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em;background:#1d1f21"><code style="color:#c5c8c6;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Inconsolata, Monaco, Consolas, &#x27;Courier New&#x27;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;float:left;padding-right:10px"><span class="react-syntax-highlighter-line-number">1
</span><span class="react-syntax-highlighter-line-number">2
</span><span class="react-syntax-highlighter-line-number">3
</span><span class="react-syntax-highlighter-line-number">4
</span><span class="react-syntax-highlighter-line-number">5
</span><span class="react-syntax-highlighter-line-number">6
</span><span class="react-syntax-highlighter-line-number">7
</span><span class="react-syntax-highlighter-line-number">8
</span><span class="react-syntax-highlighter-line-number">9
</span><span class="react-syntax-highlighter-line-number">10
</span><span class="react-syntax-highlighter-line-number">11
</span><span class="react-syntax-highlighter-line-number">12
</span><span class="react-syntax-highlighter-line-number">13
</span><span class="react-syntax-highlighter-line-number">14
</span><span class="react-syntax-highlighter-line-number">15
</span><span class="react-syntax-highlighter-line-number">16
</span><span class="react-syntax-highlighter-line-number">17
</span><span class="react-syntax-highlighter-line-number">18
</span></code><code style="color:#c5c8c6;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Inconsolata, Monaco, Consolas, &#x27;Courier New&#x27;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none">const compose = (...functors) =&gt; 
  functors.reduce(
      (s, c) =&gt; (...args) =&gt; c(s(...args))
  )

const getCartTotal = compose(
  round(2),
  sum,
)

const getCartTotalWithTax = compose(
  map(addTax),
  sum,
  round(2),
)

getCartTotal([4, 8, 1]) // 15.86
getCartTotalWithTax([4, 8, 1]) // 15.86</code></pre><p>So what have we achieved? We have reduced the amount of code that gets copied around in the project. If I need to change the tax percent - I can change it in one place, and have the change propagate across my project. It&#x27;s also very easy to change the amount of decimals when needed, without duplicating the conversion snippet. The new functions are simpler and therefore more testable.</p><h2>Higher-order components in React</h2><p>Let&#x27;s take a dive in functional React now. We will refactor a traditional class into functional component, write a few HOCs and glue them together. In the end, we&#x27;ll try to replace React with Inferno - just for fun.</p><h3>Class component</h3><p>We have a very basic React component - a shopping list. This shopping list calls an API when it‚Äôs mounted, has some basic performance optimization built in, and has a simple render method:</p><pre style="color:#c5c8c6;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Inconsolata, Monaco, Consolas, &#x27;Courier New&#x27;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em;background:#1d1f21"><code style="color:#c5c8c6;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Inconsolata, Monaco, Consolas, &#x27;Courier New&#x27;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;float:left;padding-right:10px"><span class="react-syntax-highlighter-line-number">1
</span><span class="react-syntax-highlighter-line-number">2
</span><span class="react-syntax-highlighter-line-number">3
</span><span class="react-syntax-highlighter-line-number">4
</span><span class="react-syntax-highlighter-line-number">5
</span><span class="react-syntax-highlighter-line-number">6
</span><span class="react-syntax-highlighter-line-number">7
</span><span class="react-syntax-highlighter-line-number">8
</span><span class="react-syntax-highlighter-line-number">9
</span><span class="react-syntax-highlighter-line-number">10
</span><span class="react-syntax-highlighter-line-number">11
</span><span class="react-syntax-highlighter-line-number">12
</span><span class="react-syntax-highlighter-line-number">13
</span><span class="react-syntax-highlighter-line-number">14
</span><span class="react-syntax-highlighter-line-number">15
</span><span class="react-syntax-highlighter-line-number">16
</span><span class="react-syntax-highlighter-line-number">17
</span><span class="react-syntax-highlighter-line-number">18
</span><span class="react-syntax-highlighter-line-number">19
</span><span class="react-syntax-highlighter-line-number">20
</span><span class="react-syntax-highlighter-line-number">21
</span><span class="react-syntax-highlighter-line-number">22
</span><span class="react-syntax-highlighter-line-number">23
</span><span class="react-syntax-highlighter-line-number">24
</span><span class="react-syntax-highlighter-line-number">25
</span><span class="react-syntax-highlighter-line-number">26
</span><span class="react-syntax-highlighter-line-number">27
</span><span class="react-syntax-highlighter-line-number">28
</span></code><code style="color:#c5c8c6;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Inconsolata, Monaco, Consolas, &#x27;Courier New&#x27;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none">class ShoppingList extends React.Component {
  state = {
    items: []
  }

  componentWillMount() {
    api().getList(this.props.name).then(
      items =&gt; this.setState({ items })
    );
  }

  shouldComponentUpdate(nextProps) {
    return !shallowEqual(props, nextProps);
  }

  render() {
    return (
      &lt;div className=&quot;shopping-list&quot;&gt;
        &lt;h1&gt;Shopping List for {this.props.name}&lt;/h1&gt;
        &lt;ul&gt;
          {this.state.items.map(item =&gt; (
            &lt;li&gt;{item}&lt;/li&gt;
          ))}
        &lt;/ul&gt;
      &lt;/div&gt;
    );
  }
}</code></pre><h3>Refactoring</h3><p>The obvious place to start is to take out the <code>render</code> method and make it a new function:</p><pre style="color:#c5c8c6;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Inconsolata, Monaco, Consolas, &#x27;Courier New&#x27;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em;background:#1d1f21"><code style="color:#c5c8c6;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Inconsolata, Monaco, Consolas, &#x27;Courier New&#x27;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;float:left;padding-right:10px"><span class="react-syntax-highlighter-line-number">1
</span><span class="react-syntax-highlighter-line-number">2
</span><span class="react-syntax-highlighter-line-number">3
</span><span class="react-syntax-highlighter-line-number">4
</span><span class="react-syntax-highlighter-line-number">5
</span><span class="react-syntax-highlighter-line-number">6
</span><span class="react-syntax-highlighter-line-number">7
</span><span class="react-syntax-highlighter-line-number">8
</span><span class="react-syntax-highlighter-line-number">9
</span><span class="react-syntax-highlighter-line-number">10
</span><span class="react-syntax-highlighter-line-number">11
</span><span class="react-syntax-highlighter-line-number">12
</span></code><code style="color:#c5c8c6;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Inconsolata, Monaco, Consolas, &#x27;Courier New&#x27;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none">const renderShoppingList = (props) =&gt; {
  return (
    &lt;div className=&quot;shopping-list&quot;&gt;
      &lt;h1&gt;Shopping List for {props.name}&lt;/h1&gt;
      &lt;ul&gt;
        {props.items &amp;&amp; props.items.map(item =&gt; (
          &lt;li&gt;{item}&lt;/li&gt;
        ))}
      &lt;/ul&gt;
    &lt;/div&gt;
  );
}</code></pre><p>Functions don&#x27;t have state, so the shopping cart contents have to come from <code>props</code>. We&#x27;ll talk about it in a moment.</p><p>Let&#x27;s take a look at lifecycle methods now. This concept is a React specialty, really, so we need to heave a React-specific implementation. This new function is going to take some parameters - a lifecycle specification - and pass them on to React:</p><pre style="color:#c5c8c6;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Inconsolata, Monaco, Consolas, &#x27;Courier New&#x27;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em;background:#1d1f21"><code style="color:#c5c8c6;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Inconsolata, Monaco, Consolas, &#x27;Courier New&#x27;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;float:left;padding-right:10px"><span class="react-syntax-highlighter-line-number">1
</span><span class="react-syntax-highlighter-line-number">2
</span><span class="react-syntax-highlighter-line-number">3
</span><span class="react-syntax-highlighter-line-number">4
</span><span class="react-syntax-highlighter-line-number">5
</span><span class="react-syntax-highlighter-line-number">6
</span><span class="react-syntax-highlighter-line-number">7
</span></code><code style="color:#c5c8c6;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Inconsolata, Monaco, Consolas, &#x27;Courier New&#x27;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none">const lifecycle = (spec) =&gt; (Enhanced) =&gt;
    React.createClass({
        ...spec,
        render() {
            return &lt;Enhanced {...this.props} /&gt;
        }
    })</code></pre><p>You see that in the <code>render</code> method we just render <code>Enahnced</code>. That&#x27;s the React component that is being wrapped in <code>lifecycle</code> HoC.</p><pre style="color:#c5c8c6;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Inconsolata, Monaco, Consolas, &#x27;Courier New&#x27;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em;background:#1d1f21"><code style="color:#c5c8c6;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Inconsolata, Monaco, Consolas, &#x27;Courier New&#x27;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;float:left;padding-right:10px"><span class="react-syntax-highlighter-line-number">1
</span><span class="react-syntax-highlighter-line-number">2
</span><span class="react-syntax-highlighter-line-number">3
</span><span class="react-syntax-highlighter-line-number">4
</span><span class="react-syntax-highlighter-line-number">5
</span><span class="react-syntax-highlighter-line-number">6
</span><span class="react-syntax-highlighter-line-number">7
</span><span class="react-syntax-highlighter-line-number">8
</span><span class="react-syntax-highlighter-line-number">9
</span><span class="react-syntax-highlighter-line-number">10
</span><span class="react-syntax-highlighter-line-number">11
</span><span class="react-syntax-highlighter-line-number">12
</span><span class="react-syntax-highlighter-line-number">13
</span><span class="react-syntax-highlighter-line-number">14
</span><span class="react-syntax-highlighter-line-number">15
</span><span class="react-syntax-highlighter-line-number">16
</span><span class="react-syntax-highlighter-line-number">17
</span><span class="react-syntax-highlighter-line-number">18
</span><span class="react-syntax-highlighter-line-number">19
</span><span class="react-syntax-highlighter-line-number">20
</span><span class="react-syntax-highlighter-line-number">21
</span><span class="react-syntax-highlighter-line-number">22
</span><span class="react-syntax-highlighter-line-number">23
</span><span class="react-syntax-highlighter-line-number">24
</span></code><code style="color:#c5c8c6;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Inconsolata, Monaco, Consolas, &#x27;Courier New&#x27;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none">const renderShoppingList = (props) =&gt; {
  const { name, items } = props;

  return (
    &lt;div className=&quot;shopping-list&quot;&gt;
      &lt;h1&gt;Shopping List for {this.props.name}&lt;/h1&gt;
      &lt;ul&gt;
        {this.state.items.map(item =&gt; (
          &lt;li&gt;{item}&lt;/li&gt;
        ))}
      &lt;/ul&gt;
    &lt;/div&gt;
  );
}

const lifecycleSpec = {
  componentDidMount() {
    api().getList(this.props.name).then(
      items =&gt; this.props.setItems(items)
    );
  }
}

const ShoppingList = lifecycle(lifecycleSpec)(renderShoppingList)</code></pre><p>I think you understand the idea by now. We are still missing the code that will replace the component state behaviour. </p><pre style="color:#c5c8c6;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Inconsolata, Monaco, Consolas, &#x27;Courier New&#x27;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em;background:#1d1f21"><code style="color:#c5c8c6;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Inconsolata, Monaco, Consolas, &#x27;Courier New&#x27;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;float:left;padding-right:10px"><span class="react-syntax-highlighter-line-number">1
</span><span class="react-syntax-highlighter-line-number">2
</span><span class="react-syntax-highlighter-line-number">3
</span><span class="react-syntax-highlighter-line-number">4
</span><span class="react-syntax-highlighter-line-number">5
</span><span class="react-syntax-highlighter-line-number">6
</span><span class="react-syntax-highlighter-line-number">7
</span><span class="react-syntax-highlighter-line-number">8
</span><span class="react-syntax-highlighter-line-number">9
</span><span class="react-syntax-highlighter-line-number">10
</span><span class="react-syntax-highlighter-line-number">11
</span><span class="react-syntax-highlighter-line-number">12
</span><span class="react-syntax-highlighter-line-number">13
</span><span class="react-syntax-highlighter-line-number">14
</span><span class="react-syntax-highlighter-line-number">15
</span><span class="react-syntax-highlighter-line-number">16
</span><span class="react-syntax-highlighter-line-number">17
</span><span class="react-syntax-highlighter-line-number">18
</span><span class="react-syntax-highlighter-line-number">19
</span><span class="react-syntax-highlighter-line-number">20
</span><span class="react-syntax-highlighter-line-number">21
</span><span class="react-syntax-highlighter-line-number">22
</span><span class="react-syntax-highlighter-line-number">23
</span><span class="react-syntax-highlighter-line-number">24
</span><span class="react-syntax-highlighter-line-number">25
</span><span class="react-syntax-highlighter-line-number">26
</span><span class="react-syntax-highlighter-line-number">27
</span><span class="react-syntax-highlighter-line-number">28
</span><span class="react-syntax-highlighter-line-number">29
</span><span class="react-syntax-highlighter-line-number">30
</span></code><code style="color:#c5c8c6;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Inconsolata, Monaco, Consolas, &#x27;Courier New&#x27;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none">const withState = (
  stateName,
  stateUpdaterName,
  initialState
) =&gt; Enhanced =&gt; {
  class WithState extends Component {
    state = {
      stateValue: initialState,
    }

    updateStateValue = (value) =&gt;
      this.setState(
        ({ stateValue }) =&gt; ({
          stateValue: value
        })
      )

    render() {
      return (
        &lt;Enhanced {{
          ...this.props,
          [stateName]: this.state.stateValue,
          [stateUpdaterName]: this.updateStateValue,
        }}
      /&gt;
    }
  }

  return WithState
}</code></pre><p>This new HOC will render the <code>Enhanced</code> component, and add two new props to it. The props will manage state on the parent React component . Let&#x27;s use it:</p><pre style="color:#c5c8c6;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Inconsolata, Monaco, Consolas, &#x27;Courier New&#x27;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em;background:#1d1f21"><code style="color:#c5c8c6;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Inconsolata, Monaco, Consolas, &#x27;Courier New&#x27;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;float:left;padding-right:10px"><span class="react-syntax-highlighter-line-number">1
</span><span class="react-syntax-highlighter-line-number">2
</span><span class="react-syntax-highlighter-line-number">3
</span><span class="react-syntax-highlighter-line-number">4
</span><span class="react-syntax-highlighter-line-number">5
</span><span class="react-syntax-highlighter-line-number">6
</span><span class="react-syntax-highlighter-line-number">7
</span><span class="react-syntax-highlighter-line-number">8
</span><span class="react-syntax-highlighter-line-number">9
</span><span class="react-syntax-highlighter-line-number">10
</span><span class="react-syntax-highlighter-line-number">11
</span><span class="react-syntax-highlighter-line-number">12
</span><span class="react-syntax-highlighter-line-number">13
</span><span class="react-syntax-highlighter-line-number">14
</span><span class="react-syntax-highlighter-line-number">15
</span><span class="react-syntax-highlighter-line-number">16
</span><span class="react-syntax-highlighter-line-number">17
</span><span class="react-syntax-highlighter-line-number">18
</span><span class="react-syntax-highlighter-line-number">19
</span><span class="react-syntax-highlighter-line-number">20
</span><span class="react-syntax-highlighter-line-number">21
</span><span class="react-syntax-highlighter-line-number">22
</span><span class="react-syntax-highlighter-line-number">23
</span><span class="react-syntax-highlighter-line-number">24
</span></code><code style="color:#c5c8c6;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Inconsolata, Monaco, Consolas, &#x27;Courier New&#x27;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none">const renderShoppingList = (props) =&gt; {
  const { name, items } = props;

  return (
    &lt;div className=&quot;shopping-list&quot;&gt;
      &lt;h1&gt;Shopping List for {this.props.name}&lt;/h1&gt;
      &lt;ul&gt;
        {this.state.items.map(item =&gt; (
          &lt;li&gt;{item}&lt;/li&gt;
        ))}
      &lt;/ul&gt;
    &lt;/div&gt;
  );
}

const lifecycleSpec = {
  componentDidMount() {
    api().getList(this.props.name).then(
      items =&gt; this.props.setItems(items)
    );
  }
}

const ShoppingList = withState(&#x27;items&#x27;, &#x27;setItems&#x27;, [])(lifecycle(lifecycleSpec)(renderShoppingList))</code></pre><p>Damn, the last line is ugly. Luckily, we&#x27;re just calling functions here. This means we can use <code>compose</code> function from the previous JS example.</p><h3>Refactoring result</h3><p>We&#x27;ve successfully split a tightly-coupled React class component into a render function and a set of reusable higher-order components.</p><p><code>react-fp.js</code> contains the HOCs:</p><pre style="color:#c5c8c6;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Inconsolata, Monaco, Consolas, &#x27;Courier New&#x27;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em;background:#1d1f21"><code style="color:#c5c8c6;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Inconsolata, Monaco, Consolas, &#x27;Courier New&#x27;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;float:left;padding-right:10px"><span class="react-syntax-highlighter-line-number">1
</span><span class="react-syntax-highlighter-line-number">2
</span><span class="react-syntax-highlighter-line-number">3
</span><span class="react-syntax-highlighter-line-number">4
</span><span class="react-syntax-highlighter-line-number">5
</span><span class="react-syntax-highlighter-line-number">6
</span><span class="react-syntax-highlighter-line-number">7
</span><span class="react-syntax-highlighter-line-number">8
</span><span class="react-syntax-highlighter-line-number">9
</span><span class="react-syntax-highlighter-line-number">10
</span><span class="react-syntax-highlighter-line-number">11
</span><span class="react-syntax-highlighter-line-number">12
</span><span class="react-syntax-highlighter-line-number">13
</span><span class="react-syntax-highlighter-line-number">14
</span><span class="react-syntax-highlighter-line-number">15
</span><span class="react-syntax-highlighter-line-number">16
</span><span class="react-syntax-highlighter-line-number">17
</span><span class="react-syntax-highlighter-line-number">18
</span><span class="react-syntax-highlighter-line-number">19
</span><span class="react-syntax-highlighter-line-number">20
</span><span class="react-syntax-highlighter-line-number">21
</span><span class="react-syntax-highlighter-line-number">22
</span><span class="react-syntax-highlighter-line-number">23
</span><span class="react-syntax-highlighter-line-number">24
</span><span class="react-syntax-highlighter-line-number">25
</span><span class="react-syntax-highlighter-line-number">26
</span><span class="react-syntax-highlighter-line-number">27
</span><span class="react-syntax-highlighter-line-number">28
</span><span class="react-syntax-highlighter-line-number">29
</span><span class="react-syntax-highlighter-line-number">30
</span><span class="react-syntax-highlighter-line-number">31
</span><span class="react-syntax-highlighter-line-number">32
</span><span class="react-syntax-highlighter-line-number">33
</span><span class="react-syntax-highlighter-line-number">34
</span><span class="react-syntax-highlighter-line-number">35
</span><span class="react-syntax-highlighter-line-number">36
</span><span class="react-syntax-highlighter-line-number">37
</span><span class="react-syntax-highlighter-line-number">38
</span><span class="react-syntax-highlighter-line-number">39
</span><span class="react-syntax-highlighter-line-number">40
</span><span class="react-syntax-highlighter-line-number">41
</span><span class="react-syntax-highlighter-line-number">42
</span></code><code style="color:#c5c8c6;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Inconsolata, Monaco, Consolas, &#x27;Courier New&#x27;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none">export const lifecycle = (spec) =&gt; (Enhanced) =&gt;
    React.createClass({
        ...spec,
        render() {
            return &lt;Enhanced {...this.props} /&gt;
        }
    })
export const withState = (
    stateName,
    stateUpdaterName,
    initialState
  ) =&gt; Enhanced =&gt; {
    class WithState extends Component {
      state = {
        stateValue: initialState,
      }

      updateStateValue = (value) =&gt;
        this.setState(
          ({ stateValue }) =&gt; ({
            stateValue: value
          })
        )

      render() {
        return (
          &lt;Enhanced {{
            ...this.props,
            [stateName]: this.state.stateValue,
            [stateUpdaterName]: this.updateStateValue,
          }} /&gt;
        )
      }
    }

    return WithState
  }

export const compose = (...functors) =&gt; 
    functors.reduce(
        (s, c) =&gt; (...args) =&gt; s(c(...args))
    )</code></pre><p><code>ShoppingList.jsx</code> makes use of those HOCs to abstract away all React specifics:</p><pre style="color:#c5c8c6;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Inconsolata, Monaco, Consolas, &#x27;Courier New&#x27;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em;background:#1d1f21"><code style="color:#c5c8c6;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Inconsolata, Monaco, Consolas, &#x27;Courier New&#x27;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;float:left;padding-right:10px"><span class="react-syntax-highlighter-line-number">1
</span><span class="react-syntax-highlighter-line-number">2
</span><span class="react-syntax-highlighter-line-number">3
</span><span class="react-syntax-highlighter-line-number">4
</span><span class="react-syntax-highlighter-line-number">5
</span><span class="react-syntax-highlighter-line-number">6
</span><span class="react-syntax-highlighter-line-number">7
</span><span class="react-syntax-highlighter-line-number">8
</span><span class="react-syntax-highlighter-line-number">9
</span><span class="react-syntax-highlighter-line-number">10
</span><span class="react-syntax-highlighter-line-number">11
</span><span class="react-syntax-highlighter-line-number">12
</span><span class="react-syntax-highlighter-line-number">13
</span><span class="react-syntax-highlighter-line-number">14
</span><span class="react-syntax-highlighter-line-number">15
</span><span class="react-syntax-highlighter-line-number">16
</span><span class="react-syntax-highlighter-line-number">17
</span><span class="react-syntax-highlighter-line-number">18
</span><span class="react-syntax-highlighter-line-number">19
</span><span class="react-syntax-highlighter-line-number">20
</span><span class="react-syntax-highlighter-line-number">21
</span><span class="react-syntax-highlighter-line-number">22
</span><span class="react-syntax-highlighter-line-number">23
</span><span class="react-syntax-highlighter-line-number">24
</span><span class="react-syntax-highlighter-line-number">25
</span><span class="react-syntax-highlighter-line-number">26
</span><span class="react-syntax-highlighter-line-number">27
</span><span class="react-syntax-highlighter-line-number">28
</span><span class="react-syntax-highlighter-line-number">29
</span></code><code style="color:#c5c8c6;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Inconsolata, Monaco, Consolas, &#x27;Courier New&#x27;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none">const renderShoppingList = (props) =&gt; {
  const { name, items } = props;

  return (
    &lt;div className=&quot;shopping-list&quot;&gt;
      &lt;h1&gt;Shopping List for {this.props.name}&lt;/h1&gt;
      &lt;ul&gt;
        {this.state.items.map(item =&gt; (
          &lt;li&gt;{item}&lt;/li&gt;
        ))}
      &lt;/ul&gt;
    &lt;/div&gt;
  );
}

const lifecycleSpec = {
  componentDidMount() {
    api().getList().then(
      items =&gt; this.setState({ items })
    );
  }
}

const ShoppingList = compose(
  withState(&#x27;items&#x27;, &#x27;setItems&#x27;, []),
  lifecycle(lifecycleSpec),
)(renderShoppingList);

export default ShoppingList</code></pre><h3>Experiment</h3><p>So now that we have the React-specific code moved to a separate module, let&#x27;s have some fun. I&#x27;m going to change the view library from React to Inferno, modify the <code>react-fp.js</code> to become <code>inferno-fp.js</code>. I don&#x27;t have to modify my <code>ShoppingList.js</code> code at all, since I don&#x27;t use React in it directly.</p><p>This is how <code>inferno-fp.js</code> looks like:</p><pre style="color:#c5c8c6;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Inconsolata, Monaco, Consolas, &#x27;Courier New&#x27;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em;background:#1d1f21"><code style="color:#c5c8c6;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Inconsolata, Monaco, Consolas, &#x27;Courier New&#x27;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;float:left;padding-right:10px"><span class="react-syntax-highlighter-line-number">1
</span><span class="react-syntax-highlighter-line-number">2
</span><span class="react-syntax-highlighter-line-number">3
</span><span class="react-syntax-highlighter-line-number">4
</span><span class="react-syntax-highlighter-line-number">5
</span><span class="react-syntax-highlighter-line-number">6
</span><span class="react-syntax-highlighter-line-number">7
</span><span class="react-syntax-highlighter-line-number">8
</span><span class="react-syntax-highlighter-line-number">9
</span><span class="react-syntax-highlighter-line-number">10
</span><span class="react-syntax-highlighter-line-number">11
</span><span class="react-syntax-highlighter-line-number">12
</span><span class="react-syntax-highlighter-line-number">13
</span><span class="react-syntax-highlighter-line-number">14
</span><span class="react-syntax-highlighter-line-number">15
</span><span class="react-syntax-highlighter-line-number">16
</span><span class="react-syntax-highlighter-line-number">17
</span><span class="react-syntax-highlighter-line-number">18
</span><span class="react-syntax-highlighter-line-number">19
</span><span class="react-syntax-highlighter-line-number">20
</span><span class="react-syntax-highlighter-line-number">21
</span><span class="react-syntax-highlighter-line-number">22
</span><span class="react-syntax-highlighter-line-number">23
</span><span class="react-syntax-highlighter-line-number">24
</span><span class="react-syntax-highlighter-line-number">25
</span><span class="react-syntax-highlighter-line-number">26
</span><span class="react-syntax-highlighter-line-number">27
</span><span class="react-syntax-highlighter-line-number">28
</span><span class="react-syntax-highlighter-line-number">29
</span><span class="react-syntax-highlighter-line-number">30
</span><span class="react-syntax-highlighter-line-number">31
</span><span class="react-syntax-highlighter-line-number">32
</span><span class="react-syntax-highlighter-line-number">33
</span><span class="react-syntax-highlighter-line-number">34
</span><span class="react-syntax-highlighter-line-number">35
</span><span class="react-syntax-highlighter-line-number">36
</span><span class="react-syntax-highlighter-line-number">37
</span><span class="react-syntax-highlighter-line-number">38
</span><span class="react-syntax-highlighter-line-number">39
</span><span class="react-syntax-highlighter-line-number">40
</span><span class="react-syntax-highlighter-line-number">41
</span><span class="react-syntax-highlighter-line-number">42
</span><span class="react-syntax-highlighter-line-number">43
</span><span class="react-syntax-highlighter-line-number">44
</span><span class="react-syntax-highlighter-line-number">45
</span><span class="react-syntax-highlighter-line-number">46
</span><span class="react-syntax-highlighter-line-number">47
</span><span class="react-syntax-highlighter-line-number">48
</span><span class="react-syntax-highlighter-line-number">49
</span><span class="react-syntax-highlighter-line-number">50
</span><span class="react-syntax-highlighter-line-number">51
</span><span class="react-syntax-highlighter-line-number">52
</span><span class="react-syntax-highlighter-line-number">53
</span><span class="react-syntax-highlighter-line-number">54
</span><span class="react-syntax-highlighter-line-number">55
</span></code><code style="color:#c5c8c6;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Inconsolata, Monaco, Consolas, &#x27;Courier New&#x27;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none">import { Component } from &#x27;inferno&#x27;;

/**
 * Lazy implementation of lifecycle HoC 
 * TODO: Add more lifecycle methods
 */
const lifecycle = spec =&gt; Enhanced =&gt; (props = {}) =&gt; (
  &lt;Enhanced
    {...props}
    onComponentDidMount={() =&gt; spec.componentDidMount(props)}
  /&gt;
);

const compose = (...functors) =&gt;
  functors.reduce(
    (s, c) =&gt; (...args) =&gt; s(c(...args))
  );

const withState = (
  stateName,
  stateUpdaterName,
  initialState
) =&gt; Enhanced =&gt; {
  class WithState extends Component {
    state = {
      stateValue: initialState,
    }

    updateStateValue = (value) =&gt;
      this.setState(
        ({ stateValue }) =&gt; ({
          stateValue: value
        })
      )

    render() {
      const extraProps = {
        [stateName]: this.state.stateValue,
        [stateUpdaterName]: this.updateStateValue,
      }

      return (
        &lt;Enhanced {...this.props} {...extraProps} /&gt;
      )
    }
  }

  return WithState
}

export {
  compose,
  lifecycle,
  withState,
};</code></pre><p>I&#x27;m really lazy and I didn&#x27;t implement all the lifecycle methods - but you will forgive me this, won&#x27;t you? Apart from this, the HOC interface is exactly the same. There is no need to do anything in <code>ShoppingList.js</code>, just replace the imported module. You can try the complete example on <a href="https://github.com/iakovmarkov/react-inferno-example">GitHub</a> yourself.</p><p>As I&#x27;ve said in the beginning, the practical application of this is very limited. However, it&#x27;s a great demonstration of why I prefer functional approach to programming complex applications now. Composing loosely coupled functions together enables you to replace them with relative ease. Refactoring such code is much easier as well, because modules are not dependant on one another and can be swapped out, given their APIs are compatible.</p><h2>Conclussion</h2><p>When we have applied this for the first time in Ataccama, our junior developers and newcomers were really confused with the concept. However, after a few weeks of working with the project that uses higher-order components a lot, they&#x27;ve learned how to quickly compose HOCs to get the desired behavior. Separating the business logic from the render code allowed us to have a standard UI library that is shared across different web applications.</p><p>I hope reading this has been beneficial to you. Even if you won&#x27;t rewrite your code into functional components immediately, you can apply certain ideas to other areas of programming. If you are interested in learning more about functional programming in React, check out <a href="/blog/reusable_hocs">Reusable Higher-Order Components</a>.</p><h2>Useful links</h2><ul><li><a href="https://github.com/acdlite/recompose">Recompose</a> - a library that gives you a ton of reusable HoCs, making the transition easier.</li><li><a href="https://github.com/adam-stanek/recompost">Recompost</a> - our colleague&#x27;s version of Recompose, but with TypeScript capabilities. Just awesome.</li></ul></div></div><div class="container-0-2-28 container-d0-0-2-32"><div class="content-0-2-30 content-d1-0-2-33">21.10.2017</div><div class="content-0-2-30 content-d1-0-2-33 tags-0-2-31">Tags:¬†¬†<span class="tag-0-2-34 tag-d0-0-2-35">Programming</span><span class="tag-0-2-34 tag-d1-0-2-36">Functional programming</span><span class="tag-0-2-34 tag-d2-0-2-37">React</span><span class="tag-0-2-34 tag-d3-0-2-38">Inferno</span><span class="tag-0-2-34 tag-d4-0-2-39">JavaScript</span></div></div></article></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"raw":"---\r\ntitle: Higher-Order Components in React\r\ndate: 2017-10-21\r\ntags:\r\n- Programming\r\n- Functional programming\r\n- React\r\n- Inferno\r\n- JavaScript\r\n---\r\nThis post will talk about a key conecpt in functional programming, and demonstrate it on a more-or-less practical example. \r\n---\r\n\r\n## Intro\r\n\r\nMost React developers are using object-oriented approach to React components. They create classes that tightly couple business logic with JSX code. By using functional components and composition, you can split the code very much like MVC pattern suggests. This will ensure a greater degree of separation of concerns in your code, and will make your components easier to reuse and refactor. Moreover, you can combine multiple higher-order functions into one, reusable function. This is very useful for functionality that you repeat in multiple places, like working with a REST API or validating form input.\r\n\r\nA small, but nevertheless cool thing about separating view code from business logic is that you, as a developer, can replace React with any other similar view library. The practical application of this is very limited, but I'm going to show you how it's done in the very end of this blog post.\r\n\r\nIf you're not familiar with functional programming, I'd recommend taking a look at [Funcitonal Programming in React](/blog/functional-react). \r\n\r\n## Functional composition\r\n\r\nFunctional composition is a way to use simple functions together to get a complex behaviour. Consider this example:\r\n\r\n```javascript\r\nconst getCartTotal = (prices) =\u003e {\r\n  const pricesWithTax = prices.map(p =\u003e p * 1.22)\r\n  const priceTotal = pricesWithTax.reduce((p, acc) =\u003e acc += p, 0)\r\n  const priceTotalRounded = Number(priceTotal.toFixed(2))\r\n\r\n  return priceTotalRounded\r\n}\r\n\r\ngetCartTotal([4, 8, 1]) // 15.86\r\n```\r\n\r\nThis function works well to get total price for every item in cart. But if I need to implement a function that will calculate the cart total without tax, or a price of each item with tax, I'll be tempted to copy-and-paste the code from `getCartTotal` function. \r\n\r\nA better idea is to refactor `getCartTotal` into few functions that adhere to Single Responsibility Principle and use them together. This is how it can look like:\r\n\r\n```javascript\r\nconst map = (fn) =\u003e (value) =\u003e value.map(fn)\r\nconst addTax = (value) =\u003e value * 1.22\r\nconst sum = (values) =\u003e values.reduce((acc, value) =\u003e acc += value, 0)\r\nconst round = (pos = 2) =\u003e (value) =\u003e Number(value.toFixed(pos))\r\n\r\nconst getCartTotal = (prices) =\u003e round(2)(sum(map(addTax)(prices)))\r\n\r\ngetCartTotal([4, 8, 1]) // 15.86\r\n```\r\n\r\nThe result is the same, and the new `addTax`, `sum` and `round` functions look pretty generic and reusable. The only thing that is objectively bad here is `round(2)(sum(map(addTax)(prices)))`. It's just hard to read.\r\n\r\nWhen JS is executing this line, it runs the innermost function, and passes it's return value to another function. We can write a function that will do exactly this, but with a more readable synthax:\r\n\r\n```jsx\r\nconst compose = (...functors) =\u003e \r\n  functors.reduce(\r\n      (s, c) =\u003e (...args) =\u003e c(s(...args))\r\n  )\r\n\r\nconst getCartTotal = compose(\r\n  round(2),\r\n  sum,\r\n)\r\n\r\nconst getCartTotalWithTax = compose(\r\n  map(addTax),\r\n  sum,\r\n  round(2),\r\n)\r\n\r\ngetCartTotal([4, 8, 1]) // 15.86\r\ngetCartTotalWithTax([4, 8, 1]) // 15.86\r\n```\r\n\r\nSo what have we achieved? We have reduced the amount of code that gets copied around in the project. If I need to change the tax percent - I can change it in one place, and have the change propagate across my project. It's also very easy to change the amount of decimals when needed, without duplicating the conversion snippet. The new functions are simpler and therefore more testable.\r\n\r\n## Higher-order components in React\r\n\r\nLet's take a dive in functional React now. We will refactor a traditional class into functional component, write a few HOCs and glue them together. In the end, we'll try to replace React with Inferno - just for fun.\r\n\r\n### Class component\r\n\r\nWe have a very basic React component - a shopping list. This shopping list calls an API when it‚Äôs mounted, has some basic performance optimization built in, and has a simple render method:\r\n\r\n```jsx\r\nclass ShoppingList extends React.Component {\r\n  state = {\r\n    items: []\r\n  }\r\n\r\n  componentWillMount() {\r\n    api().getList(this.props.name).then(\r\n      items =\u003e this.setState({ items })\r\n    );\r\n  }\r\n\r\n  shouldComponentUpdate(nextProps) {\r\n    return !shallowEqual(props, nextProps);\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      \u003cdiv className=\"shopping-list\"\u003e\r\n        \u003ch1\u003eShopping List for {this.props.name}\u003c/h1\u003e\r\n        \u003cul\u003e\r\n          {this.state.items.map(item =\u003e (\r\n            \u003cli\u003e{item}\u003c/li\u003e\r\n          ))}\r\n        \u003c/ul\u003e\r\n      \u003c/div\u003e\r\n    );\r\n  }\r\n}\r\n```\r\n\r\n### Refactoring\r\n\r\nThe obvious place to start is to take out the `render` method and make it a new function:\r\n\r\n```jsx\r\nconst renderShoppingList = (props) =\u003e {\r\n  return (\r\n    \u003cdiv className=\"shopping-list\"\u003e\r\n      \u003ch1\u003eShopping List for {props.name}\u003c/h1\u003e\r\n      \u003cul\u003e\r\n        {props.items \u0026\u0026 props.items.map(item =\u003e (\r\n          \u003cli\u003e{item}\u003c/li\u003e\r\n        ))}\r\n      \u003c/ul\u003e\r\n    \u003c/div\u003e\r\n  );\r\n}\r\n```\r\n\r\nFunctions don't have state, so the shopping cart contents have to come from `props`. We'll talk about it in a moment.\r\n\r\nLet's take a look at lifecycle methods now. This concept is a React specialty, really, so we need to heave a React-specific implementation. This new function is going to take some parameters - a lifecycle specification - and pass them on to React:\r\n\r\n```jsx\r\nconst lifecycle = (spec) =\u003e (Enhanced) =\u003e\r\n    React.createClass({\r\n        ...spec,\r\n        render() {\r\n            return \u003cEnhanced {...this.props} /\u003e\r\n        }\r\n    })\r\n```\r\n\r\nYou see that in the `render` method we just render `Enahnced`. That's the React component that is being wrapped in `lifecycle` HoC.\r\n\r\n\r\n```jsx\r\nconst renderShoppingList = (props) =\u003e {\r\n  const { name, items } = props;\r\n\r\n  return (\r\n    \u003cdiv className=\"shopping-list\"\u003e\r\n      \u003ch1\u003eShopping List for {this.props.name}\u003c/h1\u003e\r\n      \u003cul\u003e\r\n        {this.state.items.map(item =\u003e (\r\n          \u003cli\u003e{item}\u003c/li\u003e\r\n        ))}\r\n      \u003c/ul\u003e\r\n    \u003c/div\u003e\r\n  );\r\n}\r\n\r\nconst lifecycleSpec = {\r\n  componentDidMount() {\r\n    api().getList(this.props.name).then(\r\n      items =\u003e this.props.setItems(items)\r\n    );\r\n  }\r\n}\r\n\r\nconst ShoppingList = lifecycle(lifecycleSpec)(renderShoppingList)\r\n```\r\n\r\nI think you understand the idea by now. We are still missing the code that will replace the component state behaviour. \r\n\r\n```jsx\r\nconst withState = (\r\n  stateName,\r\n  stateUpdaterName,\r\n  initialState\r\n) =\u003e Enhanced =\u003e {\r\n  class WithState extends Component {\r\n    state = {\r\n      stateValue: initialState,\r\n    }\r\n\r\n    updateStateValue = (value) =\u003e\r\n      this.setState(\r\n        ({ stateValue }) =\u003e ({\r\n          stateValue: value\r\n        })\r\n      )\r\n\r\n    render() {\r\n      return (\r\n        \u003cEnhanced {{\r\n          ...this.props,\r\n          [stateName]: this.state.stateValue,\r\n          [stateUpdaterName]: this.updateStateValue,\r\n        }}\r\n      /\u003e\r\n    }\r\n  }\r\n\r\n  return WithState\r\n}\r\n```\r\n\r\nThis new HOC will render the `Enhanced` component, and add two new props to it. The props will manage state on the parent React component . Let's use it:\r\n\r\n```jsx\r\nconst renderShoppingList = (props) =\u003e {\r\n  const { name, items } = props;\r\n\r\n  return (\r\n    \u003cdiv className=\"shopping-list\"\u003e\r\n      \u003ch1\u003eShopping List for {this.props.name}\u003c/h1\u003e\r\n      \u003cul\u003e\r\n        {this.state.items.map(item =\u003e (\r\n          \u003cli\u003e{item}\u003c/li\u003e\r\n        ))}\r\n      \u003c/ul\u003e\r\n    \u003c/div\u003e\r\n  );\r\n}\r\n\r\nconst lifecycleSpec = {\r\n  componentDidMount() {\r\n    api().getList(this.props.name).then(\r\n      items =\u003e this.props.setItems(items)\r\n    );\r\n  }\r\n}\r\n\r\nconst ShoppingList = withState('items', 'setItems', [])(lifecycle(lifecycleSpec)(renderShoppingList))\r\n```\r\n\r\nDamn, the last line is ugly. Luckily, we're just calling functions here. This means we can use `compose` function from the previous JS example.\r\n\r\n### Refactoring result\r\n\r\nWe've successfully split a tightly-coupled React class component into a render function and a set of reusable higher-order components.\r\n\r\n`react-fp.js` contains the HOCs:\r\n\r\n```jsx\r\nexport const lifecycle = (spec) =\u003e (Enhanced) =\u003e\r\n    React.createClass({\r\n        ...spec,\r\n        render() {\r\n            return \u003cEnhanced {...this.props} /\u003e\r\n        }\r\n    })\r\nexport const withState = (\r\n    stateName,\r\n    stateUpdaterName,\r\n    initialState\r\n  ) =\u003e Enhanced =\u003e {\r\n    class WithState extends Component {\r\n      state = {\r\n        stateValue: initialState,\r\n      }\r\n\r\n      updateStateValue = (value) =\u003e\r\n        this.setState(\r\n          ({ stateValue }) =\u003e ({\r\n            stateValue: value\r\n          })\r\n        )\r\n\r\n      render() {\r\n        return (\r\n          \u003cEnhanced {{\r\n            ...this.props,\r\n            [stateName]: this.state.stateValue,\r\n            [stateUpdaterName]: this.updateStateValue,\r\n          }} /\u003e\r\n        )\r\n      }\r\n    }\r\n\r\n    return WithState\r\n  }\r\n\r\nexport const compose = (...functors) =\u003e \r\n    functors.reduce(\r\n        (s, c) =\u003e (...args) =\u003e s(c(...args))\r\n    )\r\n```\r\n\r\n`ShoppingList.jsx` makes use of those HOCs to abstract away all React specifics:\r\n\r\n```jsx\r\nconst renderShoppingList = (props) =\u003e {\r\n  const { name, items } = props;\r\n\r\n  return (\r\n    \u003cdiv className=\"shopping-list\"\u003e\r\n      \u003ch1\u003eShopping List for {this.props.name}\u003c/h1\u003e\r\n      \u003cul\u003e\r\n        {this.state.items.map(item =\u003e (\r\n          \u003cli\u003e{item}\u003c/li\u003e\r\n        ))}\r\n      \u003c/ul\u003e\r\n    \u003c/div\u003e\r\n  );\r\n}\r\n\r\nconst lifecycleSpec = {\r\n  componentDidMount() {\r\n    api().getList().then(\r\n      items =\u003e this.setState({ items })\r\n    );\r\n  }\r\n}\r\n\r\nconst ShoppingList = compose(\r\n  withState('items', 'setItems', []),\r\n  lifecycle(lifecycleSpec),\r\n)(renderShoppingList);\r\n\r\nexport default ShoppingList\r\n```\r\n\r\n### Experiment\r\n\r\nSo now that we have the React-specific code moved to a separate module, let's have some fun. I'm going to change the view library from React to Inferno, modify the `react-fp.js` to become `inferno-fp.js`. I don't have to modify my `ShoppingList.js` code at all, since I don't use React in it directly.\r\n\r\nThis is how `inferno-fp.js` looks like:\r\n\r\n```jsx\r\nimport { Component } from 'inferno';\r\n\r\n/**\r\n * Lazy implementation of lifecycle HoC \r\n * TODO: Add more lifecycle methods\r\n */\r\nconst lifecycle = spec =\u003e Enhanced =\u003e (props = {}) =\u003e (\r\n  \u003cEnhanced\r\n    {...props}\r\n    onComponentDidMount={() =\u003e spec.componentDidMount(props)}\r\n  /\u003e\r\n);\r\n\r\nconst compose = (...functors) =\u003e\r\n  functors.reduce(\r\n    (s, c) =\u003e (...args) =\u003e s(c(...args))\r\n  );\r\n\r\nconst withState = (\r\n  stateName,\r\n  stateUpdaterName,\r\n  initialState\r\n) =\u003e Enhanced =\u003e {\r\n  class WithState extends Component {\r\n    state = {\r\n      stateValue: initialState,\r\n    }\r\n\r\n    updateStateValue = (value) =\u003e\r\n      this.setState(\r\n        ({ stateValue }) =\u003e ({\r\n          stateValue: value\r\n        })\r\n      )\r\n\r\n    render() {\r\n      const extraProps = {\r\n        [stateName]: this.state.stateValue,\r\n        [stateUpdaterName]: this.updateStateValue,\r\n      }\r\n\r\n      return (\r\n        \u003cEnhanced {...this.props} {...extraProps} /\u003e\r\n      )\r\n    }\r\n  }\r\n\r\n  return WithState\r\n}\r\n\r\nexport {\r\n  compose,\r\n  lifecycle,\r\n  withState,\r\n};\r\n```\r\n\r\nI'm really lazy and I didn't implement all the lifecycle methods - but you will forgive me this, won't you? Apart from this, the HOC interface is exactly the same. There is no need to do anything in `ShoppingList.js`, just replace the imported module. You can try the complete example on [GitHub](https://github.com/iakovmarkov/react-inferno-example) yourself.\r\n\r\nAs I've said in the beginning, the practical application of this is very limited. However, it's a great demonstration of why I prefer functional approach to programming complex applications now. Composing loosely coupled functions together enables you to replace them with relative ease. Refactoring such code is much easier as well, because modules are not dependant on one another and can be swapped out, given their APIs are compatible.\r\n\r\n## Conclussion\r\n\r\nWhen we have applied this for the first time in Ataccama, our junior developers and newcomers were really confused with the concept. However, after a few weeks of working with the project that uses higher-order components a lot, they've learned how to quickly compose HOCs to get the desired behavior. Separating the business logic from the render code allowed us to have a standard UI library that is shared across different web applications.\r\n\r\nI hope reading this has been beneficial to you. Even if you won't rewrite your code into functional components immediately, you can apply certain ideas to other areas of programming. If you are interested in learning more about functional programming in React, check out [Reusable Higher-Order Components](/blog/reusable_hocs).\r\n\r\n## Useful links\r\n\r\n- [Recompose](https://github.com/acdlite/recompose) - a library that gives you a ton of reusable HoCs, making the transition easier.\r\n- [Recompost](https://github.com/adam-stanek/recompost) - our colleague's version of Recompose, but with TypeScript capabilities. Just awesome.\r\n"},"__N_SSG":true},"page":"/blog/[slug]","query":{"slug":"react_hocs"},"buildId":"XDHmRbjTjbrhjheiSpBR7","nextExport":false,"isFallback":false,"gsp":true}</script><script nomodule="" src="/_next/static/runtime/polyfills-d2ea1cc2739f90a3ff9c.js"></script><script async="" data-next-page="/_app" src="/_next/static/XDHmRbjTjbrhjheiSpBR7/pages/_app.js"></script><script async="" data-next-page="/blog/[slug]" src="/_next/static/XDHmRbjTjbrhjheiSpBR7/pages/blog/%5Bslug%5D.js"></script><script src="/_next/static/runtime/webpack-099a652a84207c43d340.js" async=""></script><script src="/_next/static/chunks/framework.619a4f70c1d4d3a29cbc.js" async=""></script><script src="/_next/static/chunks/commons.dd1d4337766320e3f3cd.js" async=""></script><script src="/_next/static/chunks/7823f1fa03b035db0019697d5756f95c6b249c6a.06fc960a10b812484c42.js" async=""></script><script src="/_next/static/runtime/main-4e8887e0577ac493b676.js" async=""></script><script src="/_next/static/chunks/9f96d65d.1337245caf768c94bbd9.js" async=""></script><script src="/_next/static/chunks/0e520e4cf0d15bb5df764f4c7bd3ed536b161189.4702076dd3fe1fe85372.js" async=""></script><script src="/_next/static/chunks/40dad8a098b120e67f2f427133882ae3c299354f.ace18cfed87d240a24a6.js" async=""></script><script src="/_next/static/chunks/11b950283c14f01b3946ede4125cdb590c919828.02b326bf6ced6da2b901.js" async=""></script><script src="/_next/static/XDHmRbjTjbrhjheiSpBR7/_buildManifest.js" async=""></script><script src="/_next/static/XDHmRbjTjbrhjheiSpBR7/_ssgManifest.js" async=""></script></body></html>