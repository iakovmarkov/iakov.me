<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><title>Reusable Higher-Order Components - iakov.me</title><link rel="icon" type="image/x-icon" href="/favicon.ico"/><meta name="description" content="In this blog post I will talk about how to create reusable higher-order components in React on a practical example - working with an API.
"/><meta property="og:title" content="Reusable Higher-Order Components - iakov.me"/><meta property="og:url" content="https://iakov.me/"/><meta property="og:image" content="https://iakov.me/profile/avatar.jpg"/><meta property="og:description" content="In this blog post I will talk about how to create reusable higher-order components in React on a practical example - working with an API.
"/><meta itemprop="name" content="Reusable Higher-Order Components - iakov.me"/><meta itemprop="description" content="In this blog post I will talk about how to create reusable higher-order components in React on a practical example - working with an API.
"/><meta itemprop="image" content="https://iakov.me/profile/avatar.jpg"/><link href="/fonts/PTSerif-Regular.ttf" rel="preload" as="font" type="font/ttf"/><link href="/fonts/PTSerif-Bold.ttf" rel="preload" as="font" type="font/ttf"/><link href="/fonts/PTSerif-RegularItalic.ttf" rel="preload" as="font" type="font/ttf"/><link href="/fonts/PTSerif-BoldItalic.ttf" rel="preload" as="font" type="font/ttf"/><link href="/fonts/Poppins-Regular.ttf" rel="preload" as="font" type="font/ttf"/><link href="/fonts/Poppins-SemiBold.ttf" rel="preload" as="font" type="font/ttf"/><link href="/fonts/Poppins-SemiBoldItalic.ttf" rel="preload" as="font" type="font/ttf"/><link href="/fonts/Poppins-BlackItalic.ttf" rel="preload" as="font" type="font/ttf"/><meta name="next-head-count" content="20"/><link rel="preload" href="/_next/static/css/42eeec1c46820da665f2.css" as="style"/><link rel="stylesheet" href="/_next/static/css/42eeec1c46820da665f2.css"/><link rel="preload" href="/_next/static/5HFLk1lVkhr6pmdWq9SEa/pages/_app.js" as="script"/><link rel="preload" href="/_next/static/5HFLk1lVkhr6pmdWq9SEa/pages/blog/%5Bslug%5D.js" as="script"/><link rel="preload" href="/_next/static/runtime/webpack-099a652a84207c43d340.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.619a4f70c1d4d3a29cbc.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons.dd1d4337766320e3f3cd.js" as="script"/><link rel="preload" href="/_next/static/chunks/fde76e73e888c82a5daf01e132015384f0cd3d06.06fc960a10b812484c42.js" as="script"/><link rel="preload" href="/_next/static/runtime/main-4e8887e0577ac493b676.js" as="script"/><link rel="preload" href="/_next/static/chunks/9f96d65d.1337245caf768c94bbd9.js" as="script"/><link rel="preload" href="/_next/static/chunks/0ff34f855579ccbc49fb9fbff5971e037b34ab7f.bb40aa3f935ffd175372.js" as="script"/><link rel="preload" href="/_next/static/chunks/ba8ec81c0d15113a39d8f927686df0996bb5c7e2.60775f4e3f4a97510535.js" as="script"/><link rel="preload" href="/_next/static/chunks/487d4b9ae112fee708658936ad5012dbc925c095.094ce1d26a41e37f5194.js" as="script"/><style type="text/css" id="server-side-styles">.content-0-2-26 {}
.content-d0-0-2-27 {}
.content-d0-0-2-27 p {
  margin: 8px 0 8px;
  vertical-align: baseline;
}
.content-d0-0-2-27 a {
  text-decoration: underline !important;
}
.content-d0-0-2-27 blockquote {
  margin: 8px 0 8px;
  padding: 0 0 0 18px;
  border-left: 4px solid #eeeeee;
}
.content-d0-0-2-27 h1, .content-d0-0-2-27 h2, .content-d0-0-2-27 h3, .content-d0-0-2-27 h4, .content-d0-0-2-27 h5, .content-d0-0-2-27 h6 {
  margin: 18px 0 8px;
}
.content-d0-0-2-27 hr {
  color: #eeeeee;
  margin: 4px 0;
}
.content-d0-0-2-27 ul, .content-d0-0-2-27 ol {
  margin: 4px 0 4px;
  padding: 0 0 0 4px;
  list-style: none;
  counter-reset: list;
}
.content-d0-0-2-27 li {
  position: relative;
  padding-left: 1.2em;
  counter-increment: list;
}
.content-d0-0-2-27 li::before {
  left: 0;
  width: 1em;
  position: absolute;
  text-align: center;
}
.content-d0-0-2-27 ul li::before {
  content: &quot;‚Ä∫&quot;;
}
.content-d0-0-2-27 ol li::before {
  content: counter(list)&quot;.&quot;;
}
.content-d0-0-2-27 li.checked::before {
  content: &quot;üóπ&quot;;
}
.content-d0-0-2-27 li.unchecked::before {
  content: &quot;‚òê&quot;;
}
.content-d0-0-2-27 table {
  width: 100%;
  margin: 8px 0;
  max-width: 100%;
  border-collapse: collapse;
}
.content-d0-0-2-27 th {
  padding: 4px 8px;
  text-align: left;
  font-family: Poppins, sans-serif;
  font-weight: 600;
}
.content-d0-0-2-27 td {
  margin: 0;
  padding: 4px 8px;
}
.content-d0-0-2-27 tr {
  border-bottom: 1px solid #eeeeee;
}
.content-d0-0-2-27 a:hover, .content-d0-0-2-27 a:active {
  color: rgb(239, 72, 0);
}
.container-0-2-3 {}
.navContainer-0-2-4 {
  width: 100%;
  display: flex;
  justify-content: center;
}
.nav-0-2-5 {}
.contentContainer-0-2-6 {}
.container-d0-0-2-7 {
  display: flex;
  background: #FFFFFF;
  min-height: 100%;
  align-items: center;
  flex-direction: column;
}
.nav-d1-0-2-8 {
  width: 100%;
  max-width: 760px;
  border-bottom: 1px solid #eeeeee;
}
.contentContainer-d2-0-2-9 {
  width: 100%;
  padding: 18px 18px;
  font-size: 16px;
  max-width: 760px;
}
.contentContainer-d2-0-2-9 h1 {
  font-size: 24px;
  font-family: Poppins, sans-serif;
}
.contentContainer-d2-0-2-9 h2 {
  font-size: 22.4px;
  font-family: Poppins, sans-serif;
}
.contentContainer-d2-0-2-9 h3 {
  font-size: 20.8px;
  font-family: Poppins, sans-serif;
}
.contentContainer-d2-0-2-9 h4 {
  font-size: 19.2px;
  font-family: Poppins, sans-serif;
}
.contentContainer-d2-0-2-9 h5 {
  font-size: 17.6px;
  font-family: Poppins, sans-serif;
}
.contentContainer-d2-0-2-9 h6 {
  font-size: 16px;
  font-family: Poppins, sans-serif;
}
.tag-0-2-34 {}
.tag-d0-0-2-35 {
  border: 1px solid #eeeeee;
  margin: 1px 4px 1px 0;
  display: inline-block;
  padding: 0 4px;
  font-style: normal;
  font-family: Poppins, sans-serif;
  font-weight: 400;
}
.tag-d1-0-2-36 {
  border: 1px solid #eeeeee;
  margin: 1px 4px 1px 0;
  display: inline-block;
  padding: 0 4px;
  font-style: normal;
  font-family: Poppins, sans-serif;
  font-weight: 400;
}
.tag-d2-0-2-37 {
  border: 1px solid #eeeeee;
  margin: 1px 4px 1px 0;
  display: inline-block;
  padding: 0 4px;
  font-style: normal;
  font-family: Poppins, sans-serif;
  font-weight: 400;
}
.tag-d3-0-2-38 {
  border: 1px solid #eeeeee;
  margin: 1px 4px 1px 0;
  display: inline-block;
  padding: 0 4px;
  font-style: normal;
  font-family: Poppins, sans-serif;
  font-weight: 400;
}
.tag-d4-0-2-39 {
  border: 1px solid #eeeeee;
  margin: 1px 4px 1px 0;
  display: inline-block;
  padding: 0 4px;
  font-style: normal;
  font-family: Poppins, sans-serif;
  font-weight: 400;
}
.container-0-2-20 {}
.title-0-2-21 {
  flex: 1;
  font-size: 24px;
}
.date-0-2-22 {}
.container-d0-0-2-23 {
  margin: 0 0 4px 0;
  display: flex;
  padding: 4px 0;
  border-bottom: 1px solid #eeeeee;
  justify-content: space-between;
}
@media only screen and (max-width: 768px) {
  .container-d0-0-2-23 {
    display: block;
  }
}
  .title-d1-0-2-24 {
    margin: 4px 0px;
  }
  .date-d2-0-2-25 {
    color: #777777;
    display: flex;
    font-size: 0.9em;
    align-items: center;
    font-family: Poppins, sans-serif;
    flex-direction: row;
  }
@media only screen and (max-width: 768px) {
  .date-d2-0-2-25 {
    display: none;
  }
}
  .readMoreLink-0-2-16 {
    display: inline-block;
    font-size: 0.8em;
  }
  .readMoreLink-0-2-16:hover, .readMoreLink-0-2-16:active {
    color: #FFFFFF;
    background: #000000;
  }
  .postBody-0-2-17 {  }
  .postBody-0-2-17 p:first-of-type::first-letter {
    float: left;
    font-size: 48px;
    line-height: 30px;
    vertical-align: baseline;
  }
  .readMoreLink-d0-0-2-18 {
    font-family: Poppins, sans-serif;
    margin: 4px 0;
    padding: 4px 8px;
    border: 2px solid #000000;
    color: #000000;
    background: #FFFFFF;
  }
  .postBody-d1-0-2-19 {  }
  .postBody-d1-0-2-19 p:first-of-type::first-letter {
    padding: 8px 4px 0 0px;
  }
  .container-0-2-1 {  }
  .container-d0-0-2-2 {
    margin: 18px 0 0;
    padding: 0 0 18px;
  }
  .nav-0-2-10 {
    font-style: italic;
    align-items: start;
    font-weight: 600;
    text-transform: uppercase;
  }
  .list-0-2-11 {
    margin: 0;
    display: flex;
    padding: 0;
    list-style: none;
    flex-direction: row;
    justify-content: center;
  }
  .listItem-0-2-12 {  }
  .link-0-2-13 {  }
  .listItem-d0-0-2-14 {
    font-family: Poppins, sans-serif;
  }
  .link-d1-0-2-15 {
    display: block;
    padding: 18px 36px;
    border-bottom: 4px solid transparent;
  }
@media only screen and (max-width: 768px) {
  .link-d1-0-2-15 {
    padding: 8px 16px;
  }
}
  .link-d1-0-2-15.isActive {
    border-bottom-color: #eeeeee;
  }
  .link-d1-0-2-15:hover, .link-d1-0-2-15:active {
    color: rgb(239, 72, 0);
    border-bottom-color: rgb(239, 72, 0);
  }
  .container-0-2-28 {  }
  .key-0-2-29 {
    text-transform: capitalize;
  }
  .content-0-2-30 {  }
  .tags-0-2-31 {
    flex-wrap: wrap;
  }
  .container-d0-0-2-32 {
    margin: 18px 0px;
    display: flex;
    padding: 18px 0px;
    border-top: 1px solid #eeeeee;
    align-items: center;
  }
@media only screen and (max-width: 768px) {
  .container-d0-0-2-32 {
    display: block;
  }
}
  .content-d1-0-2-33 {
    color: #777777;
    margin: 4px 8px 4px 0;
    display: flex;
    font-size: 0.8em;
    word-break: keep-all;
    align-items: center;
    font-family: Poppins, sans-serif;
    white-space: nowrap;
    border-right: 1px solid #eeeeee;
    padding-right: 8px;
  }
  .content-d1-0-2-33:last-child {
    border-right: none;
  }
@media only screen and (max-width: 768px) {
  .content-d1-0-2-33 {
    width: 100%;
    border-right: none;
  }
}</style></head><body><div id="__next"><div class="container-0-2-3 container-d0-0-2-7"><div class="navContainer-0-2-4"><div class="nav-0-2-5 nav-d1-0-2-8"><nav class="nav-0-2-10"><ul class="list-0-2-11"><li class="listItem-0-2-12 listItem-d0-0-2-14"><a href="/" class="link-0-2-13 link-d1-0-2-15 false">Home</a></li><li class="listItem-0-2-12 listItem-d0-0-2-14"><a href="/about" class="link-0-2-13 link-d1-0-2-15 false">About</a></li><li class="listItem-0-2-12 listItem-d0-0-2-14"><a href="/blog" class="link-0-2-13 link-d1-0-2-15 isActive">Blog</a></li><li class="listItem-0-2-12 listItem-d0-0-2-14"><a href="mailto:markov@iakov.me" class="link-0-2-13 link-d1-0-2-15 false">Contact</a></li></ul></nav></div></div><div class="contentContainer-0-2-6 contentContainer-d2-0-2-9"><div class="container-0-2-1 container-d0-0-2-2"><article><div class="container-0-2-20 container-d0-0-2-23"><h1 class="title-0-2-21 title-d1-0-2-24">Reusable Higher-Order Components</h1><div class="date-0-2-22 date-d2-0-2-25">02.12.2018</div></div><div class="postBody-0-2-17 postBody-d1-0-2-19"><div class="content-0-2-26 content-d0-0-2-27"><h2>Intro</h2><p>This is a third post about functional programming in React. In the previous posts I&#x27;ve demonstrated how FP applies to JavaScript and React, and explained the concept of higher-order components.</p><p>I believe that the main benefit of FP approach is reusability. If your business logic is separated from your render code, the later can be reused in different context or even application, given the interface for the render function is flexible enough. But the business logic itself can also be implemented as a higher-order function. You can take any piece of code that is present in multiple places in your project, give it a name and interface, and use functional composition to attach it to your components.</p><p>If you are not familiar with the concept of higher-order components, I recommend taking a look at <a href="/blog/react_hocs">Higher-Order Components in React</a> first.</p><h2>Practical example</h2><p>Let&#x27;s take a simple practical example. You are developing a single-page application that needs to talk to an API to get any data in or out. Your application has a sign-in form, and a sign-up form, that both send POST requests to server. They also display request state and have to react to errors.</p><p>It&#x27;s tempting to duplicate the calls to your API in both of those components. They use different API endpoints, they handle errors differently, the data that they send and receive is also different. But if you consider an SPA that has a hundred of API calls, repeated across tens of modules, you will get a different picture. The amount of boilerplate code to set request state, handle errors or pass the response will become the vast majority of the code you duplicate. This makes it error-prone, hard to test and messy.</p><p>We will refactor those forms to use a new higher-order component that handles talking to an API. This HOC will itself be composed of smaller HOCs, to demonstrate the idea once more.</p><h3>Form classes</h3><p>Those are our two forms, implemented as classic React class components.</p><pre style="color:#c5c8c6;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Inconsolata, Monaco, Consolas, &#x27;Courier New&#x27;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em;background:#1d1f21"><code style="color:#c5c8c6;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Inconsolata, Monaco, Consolas, &#x27;Courier New&#x27;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;float:left;padding-right:10px"><span class="react-syntax-highlighter-line-number">1
</span><span class="react-syntax-highlighter-line-number">2
</span><span class="react-syntax-highlighter-line-number">3
</span><span class="react-syntax-highlighter-line-number">4
</span><span class="react-syntax-highlighter-line-number">5
</span><span class="react-syntax-highlighter-line-number">6
</span><span class="react-syntax-highlighter-line-number">7
</span><span class="react-syntax-highlighter-line-number">8
</span><span class="react-syntax-highlighter-line-number">9
</span><span class="react-syntax-highlighter-line-number">10
</span><span class="react-syntax-highlighter-line-number">11
</span><span class="react-syntax-highlighter-line-number">12
</span><span class="react-syntax-highlighter-line-number">13
</span><span class="react-syntax-highlighter-line-number">14
</span><span class="react-syntax-highlighter-line-number">15
</span><span class="react-syntax-highlighter-line-number">16
</span><span class="react-syntax-highlighter-line-number">17
</span><span class="react-syntax-highlighter-line-number">18
</span><span class="react-syntax-highlighter-line-number">19
</span><span class="react-syntax-highlighter-line-number">20
</span><span class="react-syntax-highlighter-line-number">21
</span><span class="react-syntax-highlighter-line-number">22
</span><span class="react-syntax-highlighter-line-number">23
</span><span class="react-syntax-highlighter-line-number">24
</span><span class="react-syntax-highlighter-line-number">25
</span><span class="react-syntax-highlighter-line-number">26
</span><span class="react-syntax-highlighter-line-number">27
</span><span class="react-syntax-highlighter-line-number">28
</span><span class="react-syntax-highlighter-line-number">29
</span><span class="react-syntax-highlighter-line-number">30
</span><span class="react-syntax-highlighter-line-number">31
</span><span class="react-syntax-highlighter-line-number">32
</span><span class="react-syntax-highlighter-line-number">33
</span><span class="react-syntax-highlighter-line-number">34
</span><span class="react-syntax-highlighter-line-number">35
</span><span class="react-syntax-highlighter-line-number">36
</span><span class="react-syntax-highlighter-line-number">37
</span><span class="react-syntax-highlighter-line-number">38
</span><span class="react-syntax-highlighter-line-number">39
</span><span class="react-syntax-highlighter-line-number">40
</span><span class="react-syntax-highlighter-line-number">41
</span><span class="react-syntax-highlighter-line-number">42
</span></code><code style="color:#c5c8c6;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Inconsolata, Monaco, Consolas, &#x27;Courier New&#x27;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none">class LoginForm extends React.Component {
    state = {
        submitting: false,
        error: null,
        success: null,
    }

    handleSubmit() {
        this.setState({ submitting: true })
        const data = {
            email: document.querySelector(&#x27;#email&#x27;).value,
            password: document.querySelector(&#x27;#password&#x27;).value,
        }
        api().post(&#x27;/login&#x27;, JSON.stringify(data)).then(
            (res) =&gt; {
                const error = res.error || this.state.error
                const success = res.code === 200 || this.state.success

                this.setState({ submitting: false, error, success })
            }
        )
    }

    render() {
        if (this.state.submitting) {
            return &lt;span&gt;Submitting...&lt;/span&gt;
        }
        if (this.state.error) {
            return &lt;span&gt;An error has occured! Try again. More info: {this.state.error}&lt;/span&gt;
        }
        if (this.state.success) {
            return &lt;span&gt;Logged in successfully, redirecting...&lt;/span&gt;
        }
        return (
            &lt;form onSubmit={this.handleSubmit}&gt;
                &lt;input name=&quot;email&quot; id=&quot;email&quot; placeholder=&quot;Email&quot; /&gt;
                &lt;input name=&quot;password&quot; id=&quot;password&quot; type=&quot;password&quot; /&gt;
                &lt;button type=&quot;submit&quot; value=&quot;Log in&quot;/&gt;
            &lt;/form&gt;
        )
    }
}</code></pre><pre style="color:#c5c8c6;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Inconsolata, Monaco, Consolas, &#x27;Courier New&#x27;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em;background:#1d1f21"><code style="color:#c5c8c6;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Inconsolata, Monaco, Consolas, &#x27;Courier New&#x27;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;float:left;padding-right:10px"><span class="react-syntax-highlighter-line-number">1
</span><span class="react-syntax-highlighter-line-number">2
</span><span class="react-syntax-highlighter-line-number">3
</span><span class="react-syntax-highlighter-line-number">4
</span><span class="react-syntax-highlighter-line-number">5
</span><span class="react-syntax-highlighter-line-number">6
</span><span class="react-syntax-highlighter-line-number">7
</span><span class="react-syntax-highlighter-line-number">8
</span><span class="react-syntax-highlighter-line-number">9
</span><span class="react-syntax-highlighter-line-number">10
</span><span class="react-syntax-highlighter-line-number">11
</span><span class="react-syntax-highlighter-line-number">12
</span><span class="react-syntax-highlighter-line-number">13
</span><span class="react-syntax-highlighter-line-number">14
</span><span class="react-syntax-highlighter-line-number">15
</span><span class="react-syntax-highlighter-line-number">16
</span><span class="react-syntax-highlighter-line-number">17
</span><span class="react-syntax-highlighter-line-number">18
</span><span class="react-syntax-highlighter-line-number">19
</span><span class="react-syntax-highlighter-line-number">20
</span><span class="react-syntax-highlighter-line-number">21
</span><span class="react-syntax-highlighter-line-number">22
</span><span class="react-syntax-highlighter-line-number">23
</span><span class="react-syntax-highlighter-line-number">24
</span><span class="react-syntax-highlighter-line-number">25
</span><span class="react-syntax-highlighter-line-number">26
</span><span class="react-syntax-highlighter-line-number">27
</span><span class="react-syntax-highlighter-line-number">28
</span><span class="react-syntax-highlighter-line-number">29
</span><span class="react-syntax-highlighter-line-number">30
</span><span class="react-syntax-highlighter-line-number">31
</span><span class="react-syntax-highlighter-line-number">32
</span><span class="react-syntax-highlighter-line-number">33
</span><span class="react-syntax-highlighter-line-number">34
</span><span class="react-syntax-highlighter-line-number">35
</span><span class="react-syntax-highlighter-line-number">36
</span><span class="react-syntax-highlighter-line-number">37
</span><span class="react-syntax-highlighter-line-number">38
</span><span class="react-syntax-highlighter-line-number">39
</span><span class="react-syntax-highlighter-line-number">40
</span><span class="react-syntax-highlighter-line-number">41
</span><span class="react-syntax-highlighter-line-number">42
</span><span class="react-syntax-highlighter-line-number">43
</span><span class="react-syntax-highlighter-line-number">44
</span><span class="react-syntax-highlighter-line-number">45
</span><span class="react-syntax-highlighter-line-number">46
</span><span class="react-syntax-highlighter-line-number">47
</span><span class="react-syntax-highlighter-line-number">48
</span><span class="react-syntax-highlighter-line-number">49
</span><span class="react-syntax-highlighter-line-number">50
</span><span class="react-syntax-highlighter-line-number">51
</span><span class="react-syntax-highlighter-line-number">52
</span><span class="react-syntax-highlighter-line-number">53
</span><span class="react-syntax-highlighter-line-number">54
</span><span class="react-syntax-highlighter-line-number">55
</span><span class="react-syntax-highlighter-line-number">56
</span></code><code style="color:#c5c8c6;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Inconsolata, Monaco, Consolas, &#x27;Courier New&#x27;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none">class RegisterForm extends React.Component {
    state = {
        submitting: false,
        error: null,
        success: null,
    }

    handleSubmit() {
        const email = document.querySelector(&#x27;#email&#x27;).value
        const username = document.querySelector(&#x27;#username&#x27;).value
        const password = document.querySelector(&#x27;#password&#x27;).value
        const password_confirm = document.querySelector(&#x27;#password_confirm&#x27;).value
        
        if (password !== password_confirm) {
            alert(&quot;Passowrds don&#x27;t match!&quot;)
            return
        }

        this.setState({ submitting: true })
        const data = {
            username,
            email,
            password,
            password_confirm,
        }
        api().post(&#x27;/signup&#x27;, JSON.stringify(data)).then(
            (res) =&gt; {
                const error = res.error || this.state.error
                const success = res.code === 200 || this.state.success

                this.setState({ submitting: false, error, success })
            }
        )
    }

    render() {
        if (this.state.submitting) {
            return &lt;span&gt;Submitting...&lt;/span&gt;
        }
        if (this.state.error) {
            return &lt;span&gt;An error has occured! Try again. More info: {this.state.error}&lt;/span&gt;
        }
        if (this.state.success) {
            return &lt;span&gt;Account created successfully, redirecting...&lt;/span&gt;
        }
        return (
            &lt;form onSubmit={this.handleSubmit}&gt;
                &lt;input name=&quot;username&quot; id=&quot;username&quot; placeholder=&quot;Username&quot; /&gt;
                &lt;input name=&quot;email&quot; id=&quot;email&quot; placeholder=&quot;Email&quot; /&gt;
                &lt;input name=&quot;password&quot; id=&quot;password&quot; type=&quot;password&quot; /&gt;
                &lt;input name=&quot;password_confirm&quot; id=&quot;password_confirm&quot; type=&quot;password&quot; /&gt;
                &lt;button type=&quot;submit&quot; value=&quot;Sign up&quot;/&gt;
            &lt;/form&gt;
        )
    }
}</code></pre><p>Even with two forms, you can see how much of the code is duplicated. Most of it is boilerplate that you will duplicate every time you need to get something from the API.</p><h3>Creating a complex HOC</h3><p>Let&#x27;s refactor those components using functional programming techniques. We will create a higher-order component that injects request state, server response and a handler function into the component it will enhance.</p><p>To save time, we won&#x27;t implement <code>compose</code>, <code>withState</code> or any other higher-order function. Instead, let&#x27;s use <a href="https://github.com/acdlite/recompose">Recompose</a> - a very well-made and well-documented library full of basic HOCs like that.</p><p>Let&#x27;s move all API-related code into a higher-order component:</p><pre style="color:#c5c8c6;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Inconsolata, Monaco, Consolas, &#x27;Courier New&#x27;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em;background:#1d1f21"><code style="color:#c5c8c6;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Inconsolata, Monaco, Consolas, &#x27;Courier New&#x27;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;float:left;padding-right:10px"><span class="react-syntax-highlighter-line-number">1
</span><span class="react-syntax-highlighter-line-number">2
</span><span class="react-syntax-highlighter-line-number">3
</span><span class="react-syntax-highlighter-line-number">4
</span><span class="react-syntax-highlighter-line-number">5
</span><span class="react-syntax-highlighter-line-number">6
</span><span class="react-syntax-highlighter-line-number">7
</span><span class="react-syntax-highlighter-line-number">8
</span><span class="react-syntax-highlighter-line-number">9
</span><span class="react-syntax-highlighter-line-number">10
</span><span class="react-syntax-highlighter-line-number">11
</span><span class="react-syntax-highlighter-line-number">12
</span><span class="react-syntax-highlighter-line-number">13
</span><span class="react-syntax-highlighter-line-number">14
</span><span class="react-syntax-highlighter-line-number">15
</span><span class="react-syntax-highlighter-line-number">16
</span><span class="react-syntax-highlighter-line-number">17
</span><span class="react-syntax-highlighter-line-number">18
</span></code><code style="color:#c5c8c6;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Inconsolata, Monaco, Consolas, &#x27;Courier New&#x27;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none">const withApi = (endpoint, method) =&gt; compose(
    withState(&#x27;apiState&#x27;, &#x27;setApiState&#x27;, { pending: false, error: null, response: null }),
    withHandlers((props) =&gt; ({
        apiRequest: (data) =&gt; {
            const call = api()[method]

            props.setApiState({ pending: true })

            call(endpoint, data).then((res) =&gt; {
                const error = res.error || props.error
                const response = res.code === 200 ? res.body : props.response

                props.setApiState.setState({ pending: false, error, response })
            })
        }
    })),
    omitProps([&#x27;setApiState&#x27;]),
)</code></pre><p>As you see, we&#x27;ve moved all the API-related code into this reusable higher-order component. It uses other simple HOCs to create pretty complex behaviour.</p><h3>Using the HOC</h3><p>Now, let&#x27;s refactor our form components to use the <code>withApi</code> HOC. The goal is to remove all API implementation details, and use props that are passed down instead.</p><p>The results look like this:</p><pre style="color:#c5c8c6;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Inconsolata, Monaco, Consolas, &#x27;Courier New&#x27;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em;background:#1d1f21"><code style="color:#c5c8c6;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Inconsolata, Monaco, Consolas, &#x27;Courier New&#x27;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;float:left;padding-right:10px"><span class="react-syntax-highlighter-line-number">1
</span><span class="react-syntax-highlighter-line-number">2
</span><span class="react-syntax-highlighter-line-number">3
</span><span class="react-syntax-highlighter-line-number">4
</span><span class="react-syntax-highlighter-line-number">5
</span><span class="react-syntax-highlighter-line-number">6
</span><span class="react-syntax-highlighter-line-number">7
</span><span class="react-syntax-highlighter-line-number">8
</span><span class="react-syntax-highlighter-line-number">9
</span><span class="react-syntax-highlighter-line-number">10
</span><span class="react-syntax-highlighter-line-number">11
</span><span class="react-syntax-highlighter-line-number">12
</span><span class="react-syntax-highlighter-line-number">13
</span><span class="react-syntax-highlighter-line-number">14
</span><span class="react-syntax-highlighter-line-number">15
</span><span class="react-syntax-highlighter-line-number">16
</span><span class="react-syntax-highlighter-line-number">17
</span><span class="react-syntax-highlighter-line-number">18
</span><span class="react-syntax-highlighter-line-number">19
</span><span class="react-syntax-highlighter-line-number">20
</span><span class="react-syntax-highlighter-line-number">21
</span><span class="react-syntax-highlighter-line-number">22
</span><span class="react-syntax-highlighter-line-number">23
</span><span class="react-syntax-highlighter-line-number">24
</span><span class="react-syntax-highlighter-line-number">25
</span><span class="react-syntax-highlighter-line-number">26
</span><span class="react-syntax-highlighter-line-number">27
</span><span class="react-syntax-highlighter-line-number">28
</span><span class="react-syntax-highlighter-line-number">29
</span><span class="react-syntax-highlighter-line-number">30
</span><span class="react-syntax-highlighter-line-number">31
</span><span class="react-syntax-highlighter-line-number">32
</span><span class="react-syntax-highlighter-line-number">33
</span><span class="react-syntax-highlighter-line-number">34
</span><span class="react-syntax-highlighter-line-number">35
</span><span class="react-syntax-highlighter-line-number">36
</span><span class="react-syntax-highlighter-line-number">37
</span><span class="react-syntax-highlighter-line-number">38
</span><span class="react-syntax-highlighter-line-number">39
</span><span class="react-syntax-highlighter-line-number">40
</span><span class="react-syntax-highlighter-line-number">41
</span><span class="react-syntax-highlighter-line-number">42
</span><span class="react-syntax-highlighter-line-number">43
</span><span class="react-syntax-highlighter-line-number">44
</span><span class="react-syntax-highlighter-line-number">45
</span><span class="react-syntax-highlighter-line-number">46
</span><span class="react-syntax-highlighter-line-number">47
</span><span class="react-syntax-highlighter-line-number">48
</span><span class="react-syntax-highlighter-line-number">49
</span><span class="react-syntax-highlighter-line-number">50
</span><span class="react-syntax-highlighter-line-number">51
</span><span class="react-syntax-highlighter-line-number">52
</span><span class="react-syntax-highlighter-line-number">53
</span><span class="react-syntax-highlighter-line-number">54
</span><span class="react-syntax-highlighter-line-number">55
</span><span class="react-syntax-highlighter-line-number">56
</span><span class="react-syntax-highlighter-line-number">57
</span><span class="react-syntax-highlighter-line-number">58
</span><span class="react-syntax-highlighter-line-number">59
</span><span class="react-syntax-highlighter-line-number">60
</span><span class="react-syntax-highlighter-line-number">61
</span><span class="react-syntax-highlighter-line-number">62
</span><span class="react-syntax-highlighter-line-number">63
</span><span class="react-syntax-highlighter-line-number">64
</span><span class="react-syntax-highlighter-line-number">65
</span><span class="react-syntax-highlighter-line-number">66
</span><span class="react-syntax-highlighter-line-number">67
</span></code><code style="color:#c5c8c6;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Inconsolata, Monaco, Consolas, &#x27;Courier New&#x27;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none">const LoginForm = withApi(&#x27;/login&#x27;, &#x27;post&#x27;)(
    (props) =&gt; {
        if (props.apiState.pending) {
            return &lt;span&gt;Submitting...&lt;/span&gt;
        }
        if (props.apiState.error) {
            return &lt;span&gt;An error has occured! Try again. More info: {props.apiState.error}&lt;/span&gt;
        }
        if (props.apiState.response) {
            return &lt;span&gt;Logged in successfully, redirecting...&lt;/span&gt;
        }
        return (
            &lt;form
                onSubmit={() =&gt; props.apiRequest({
                    email: document.querySelector(&#x27;#email&#x27;).value,
                    password: document.querySelector(&#x27;#password&#x27;).value,
                })}
            &gt;
                &lt;input name=&quot;email&quot; id=&quot;email&quot; placeholder=&quot;Email&quot; /&gt;
                &lt;input name=&quot;password&quot; id=&quot;password&quot; type=&quot;password&quot; /&gt;
                &lt;button type=&quot;submit&quot; value=&quot;Log in&quot;/&gt;
            &lt;/form&gt;
        )
    }
)

const RegisterForm = compose(
    withApi(&#x27;/register&#x27;, &#x27;post&#x27;),
    withHandlers(props =&gt; ({
        handleSubmit: (data) =&gt; {
            if (data.password !== data.password_confirm) {
                alert(&quot;Passowrds don&#x27;t match!&quot;)
                return
            }

            props.apiRequest(data)
        }
    }))
)(
    (props) =&gt; {
        if (props.apiState.pending) {
            return &lt;span&gt;Submitting...&lt;/span&gt;
        }
        if (props.apiState.error) {
            return &lt;span&gt;An error has occured! Try again. More info: {props.apiState.error}&lt;/span&gt;
        }
        if (props.apiState.response) {
            return &lt;span&gt;Account created successfully, redirecting...&lt;/span&gt;
        }
        return (
            &lt;form 
                onSubmit={() =&gt; props.handleSubmit({
                    username: document.querySelector(&#x27;#username&#x27;).value,
                    email: document.querySelector(&#x27;#email&#x27;).value,
                    password: document.querySelector(&#x27;#password&#x27;).value,
                    password_confirm: document.querySelector(&#x27;#password_confirm&#x27;).value,
                })}
            &gt;
                &lt;input name=&quot;username&quot; id=&quot;username&quot; placeholder=&quot;Username&quot; /&gt;
                &lt;input name=&quot;email&quot; id=&quot;email&quot; placeholder=&quot;Email&quot; /&gt;
                &lt;input name=&quot;password&quot; id=&quot;password&quot; type=&quot;password&quot; /&gt;
                &lt;input name=&quot;password_confirm&quot; id=&quot;password_confirm&quot; type=&quot;password&quot; /&gt;
                &lt;button type=&quot;submit&quot; value=&quot;Sign up&quot;/&gt;
            &lt;/form&gt;
        )
    }
)</code></pre><p>As you can see, the usage of <code>withApi</code> is really simple - it only needs two parameters, and it passes down two new props - <code>apiState</code> and <code>apiRequest</code>. It&#x27;s interface can be extended via optional arguments later. </p><p>if we want to do something to the data before sending it to the server, like validate or transform it, we can use a higher-order component again. I&#x27;ve done it in <code>RegisterForm</code> to demonstrate how to implement non-standard cases while still reaping the beneifts of functional composition.</p><p>The code above can be further improved by moving code related to API request state into a separate component, but it&#x27;s out of scope of this post.</p><h2>Conclussion</h2><p>This post is meant to be the last in the series about functional programming in React. I wrote it to explain the concepts to a relatively inexperienced developer, or someone who is coming from an object-oriented language like Java. I believe that I gave a good overview - from showing how functional programming is native to JavaScript to creating a reusable higher-order component.</p><p>I don&#x27;t think that FP is necessarily superior to object-oriented approach, but it makes a lot of sense to me in context of React. React <a href="https://reactjs.org/docs/composition-vs-inheritance.html">documentation</a> mentions FP a lot, and core team members have <a href="https://twitter.com/dan_abramov/status/752643494972383232">expressed preference for it</a>. </p><p>My experience tells me that functional programming works well in a very big codebase that is shared across different product teams. Working with the functional code was good developer experience, it fascilitated a lot of code reuse and encouraged engineers to have good test coverage of reused code. FP became my favorite paradigm, and I have learned to apply it in other languages like Python and Go.</p><h2>Useful links</h2><ul><li><a href="https://blog.ploeh.dk/2014/03/10/solid-the-next-step-is-functional/">SOLID: The next step is functional</a> - an article about the virtues of functional programming.</li></ul></div></div><div class="container-0-2-28 container-d0-0-2-32"><div class="content-0-2-30 content-d1-0-2-33">02.12.2018</div><div class="content-0-2-30 content-d1-0-2-33 tags-0-2-31">Tags:¬†¬†<span class="tag-0-2-34 tag-d0-0-2-35">Programming</span><span class="tag-0-2-34 tag-d1-0-2-36">Functional programming</span><span class="tag-0-2-34 tag-d2-0-2-37">React</span><span class="tag-0-2-34 tag-d3-0-2-38">Recompose</span><span class="tag-0-2-34 tag-d4-0-2-39">JavaScript</span></div></div></article></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"raw":"---\r\ntitle: Reusable Higher-Order Components\r\ndate: 2018-12-02\r\ntags:\r\n- Programming\r\n- Functional programming\r\n- React\r\n- Recompose\r\n- JavaScript\r\n---\r\nIn this blog post I will talk about how to create reusable higher-order components in React on a practical example - working with an API.\r\n---\r\n\r\n## Intro\r\n\r\nThis is a third post about functional programming in React. In the previous posts I've demonstrated how FP applies to JavaScript and React, and explained the concept of higher-order components.\r\n\r\nI believe that the main benefit of FP approach is reusability. If your business logic is separated from your render code, the later can be reused in different context or even application, given the interface for the render function is flexible enough. But the business logic itself can also be implemented as a higher-order function. You can take any piece of code that is present in multiple places in your project, give it a name and interface, and use functional composition to attach it to your components.\r\n\r\nIf you are not familiar with the concept of higher-order components, I recommend taking a look at [Higher-Order Components in React](/blog/react_hocs) first.\r\n\r\n## Practical example\r\n\r\nLet's take a simple practical example. You are developing a single-page application that needs to talk to an API to get any data in or out. Your application has a sign-in form, and a sign-up form, that both send POST requests to server. They also display request state and have to react to errors.\r\n\r\nIt's tempting to duplicate the calls to your API in both of those components. They use different API endpoints, they handle errors differently, the data that they send and receive is also different. But if you consider an SPA that has a hundred of API calls, repeated across tens of modules, you will get a different picture. The amount of boilerplate code to set request state, handle errors or pass the response will become the vast majority of the code you duplicate. This makes it error-prone, hard to test and messy.\r\n\r\nWe will refactor those forms to use a new higher-order component that handles talking to an API. This HOC will itself be composed of smaller HOCs, to demonstrate the idea once more.\r\n\r\n### Form classes\r\n\r\nThose are our two forms, implemented as classic React class components.\r\n\r\n```jsx\r\nclass LoginForm extends React.Component {\r\n    state = {\r\n        submitting: false,\r\n        error: null,\r\n        success: null,\r\n    }\r\n\r\n    handleSubmit() {\r\n        this.setState({ submitting: true })\r\n        const data = {\r\n            email: document.querySelector('#email').value,\r\n            password: document.querySelector('#password').value,\r\n        }\r\n        api().post('/login', JSON.stringify(data)).then(\r\n            (res) =\u003e {\r\n                const error = res.error || this.state.error\r\n                const success = res.code === 200 || this.state.success\r\n\r\n                this.setState({ submitting: false, error, success })\r\n            }\r\n        )\r\n    }\r\n\r\n    render() {\r\n        if (this.state.submitting) {\r\n            return \u003cspan\u003eSubmitting...\u003c/span\u003e\r\n        }\r\n        if (this.state.error) {\r\n            return \u003cspan\u003eAn error has occured! Try again. More info: {this.state.error}\u003c/span\u003e\r\n        }\r\n        if (this.state.success) {\r\n            return \u003cspan\u003eLogged in successfully, redirecting...\u003c/span\u003e\r\n        }\r\n        return (\r\n            \u003cform onSubmit={this.handleSubmit}\u003e\r\n                \u003cinput name=\"email\" id=\"email\" placeholder=\"Email\" /\u003e\r\n                \u003cinput name=\"password\" id=\"password\" type=\"password\" /\u003e\r\n                \u003cbutton type=\"submit\" value=\"Log in\"/\u003e\r\n            \u003c/form\u003e\r\n        )\r\n    }\r\n}\r\n```\r\n\r\n```jsx\r\nclass RegisterForm extends React.Component {\r\n    state = {\r\n        submitting: false,\r\n        error: null,\r\n        success: null,\r\n    }\r\n\r\n    handleSubmit() {\r\n        const email = document.querySelector('#email').value\r\n        const username = document.querySelector('#username').value\r\n        const password = document.querySelector('#password').value\r\n        const password_confirm = document.querySelector('#password_confirm').value\r\n        \r\n        if (password !== password_confirm) {\r\n            alert(\"Passowrds don't match!\")\r\n            return\r\n        }\r\n\r\n        this.setState({ submitting: true })\r\n        const data = {\r\n            username,\r\n            email,\r\n            password,\r\n            password_confirm,\r\n        }\r\n        api().post('/signup', JSON.stringify(data)).then(\r\n            (res) =\u003e {\r\n                const error = res.error || this.state.error\r\n                const success = res.code === 200 || this.state.success\r\n\r\n                this.setState({ submitting: false, error, success })\r\n            }\r\n        )\r\n    }\r\n\r\n    render() {\r\n        if (this.state.submitting) {\r\n            return \u003cspan\u003eSubmitting...\u003c/span\u003e\r\n        }\r\n        if (this.state.error) {\r\n            return \u003cspan\u003eAn error has occured! Try again. More info: {this.state.error}\u003c/span\u003e\r\n        }\r\n        if (this.state.success) {\r\n            return \u003cspan\u003eAccount created successfully, redirecting...\u003c/span\u003e\r\n        }\r\n        return (\r\n            \u003cform onSubmit={this.handleSubmit}\u003e\r\n                \u003cinput name=\"username\" id=\"username\" placeholder=\"Username\" /\u003e\r\n                \u003cinput name=\"email\" id=\"email\" placeholder=\"Email\" /\u003e\r\n                \u003cinput name=\"password\" id=\"password\" type=\"password\" /\u003e\r\n                \u003cinput name=\"password_confirm\" id=\"password_confirm\" type=\"password\" /\u003e\r\n                \u003cbutton type=\"submit\" value=\"Sign up\"/\u003e\r\n            \u003c/form\u003e\r\n        )\r\n    }\r\n}\r\n```\r\n\r\nEven with two forms, you can see how much of the code is duplicated. Most of it is boilerplate that you will duplicate every time you need to get something from the API.\r\n\r\n### Creating a complex HOC\r\n\r\nLet's refactor those components using functional programming techniques. We will create a higher-order component that injects request state, server response and a handler function into the component it will enhance.\r\n\r\nTo save time, we won't implement `compose`, `withState` or any other higher-order function. Instead, let's use [Recompose](https://github.com/acdlite/recompose) - a very well-made and well-documented library full of basic HOCs like that.\r\n\r\nLet's move all API-related code into a higher-order component:\r\n\r\n```javascript\r\nconst withApi = (endpoint, method) =\u003e compose(\r\n    withState('apiState', 'setApiState', { pending: false, error: null, response: null }),\r\n    withHandlers((props) =\u003e ({\r\n        apiRequest: (data) =\u003e {\r\n            const call = api()[method]\r\n\r\n            props.setApiState({ pending: true })\r\n\r\n            call(endpoint, data).then((res) =\u003e {\r\n                const error = res.error || props.error\r\n                const response = res.code === 200 ? res.body : props.response\r\n\r\n                props.setApiState.setState({ pending: false, error, response })\r\n            })\r\n        }\r\n    })),\r\n    omitProps(['setApiState']),\r\n)\r\n```\r\n\r\nAs you see, we've moved all the API-related code into this reusable higher-order component. It uses other simple HOCs to create pretty complex behaviour.\r\n\r\n### Using the HOC\r\n\r\nNow, let's refactor our form components to use the `withApi` HOC. The goal is to remove all API implementation details, and use props that are passed down instead.\r\n\r\nThe results look like this:\r\n\r\n```jsx\r\nconst LoginForm = withApi('/login', 'post')(\r\n    (props) =\u003e {\r\n        if (props.apiState.pending) {\r\n            return \u003cspan\u003eSubmitting...\u003c/span\u003e\r\n        }\r\n        if (props.apiState.error) {\r\n            return \u003cspan\u003eAn error has occured! Try again. More info: {props.apiState.error}\u003c/span\u003e\r\n        }\r\n        if (props.apiState.response) {\r\n            return \u003cspan\u003eLogged in successfully, redirecting...\u003c/span\u003e\r\n        }\r\n        return (\r\n            \u003cform\r\n                onSubmit={() =\u003e props.apiRequest({\r\n                    email: document.querySelector('#email').value,\r\n                    password: document.querySelector('#password').value,\r\n                })}\r\n            \u003e\r\n                \u003cinput name=\"email\" id=\"email\" placeholder=\"Email\" /\u003e\r\n                \u003cinput name=\"password\" id=\"password\" type=\"password\" /\u003e\r\n                \u003cbutton type=\"submit\" value=\"Log in\"/\u003e\r\n            \u003c/form\u003e\r\n        )\r\n    }\r\n)\r\n\r\nconst RegisterForm = compose(\r\n    withApi('/register', 'post'),\r\n    withHandlers(props =\u003e ({\r\n        handleSubmit: (data) =\u003e {\r\n            if (data.password !== data.password_confirm) {\r\n                alert(\"Passowrds don't match!\")\r\n                return\r\n            }\r\n\r\n            props.apiRequest(data)\r\n        }\r\n    }))\r\n)(\r\n    (props) =\u003e {\r\n        if (props.apiState.pending) {\r\n            return \u003cspan\u003eSubmitting...\u003c/span\u003e\r\n        }\r\n        if (props.apiState.error) {\r\n            return \u003cspan\u003eAn error has occured! Try again. More info: {props.apiState.error}\u003c/span\u003e\r\n        }\r\n        if (props.apiState.response) {\r\n            return \u003cspan\u003eAccount created successfully, redirecting...\u003c/span\u003e\r\n        }\r\n        return (\r\n            \u003cform \r\n                onSubmit={() =\u003e props.handleSubmit({\r\n                    username: document.querySelector('#username').value,\r\n                    email: document.querySelector('#email').value,\r\n                    password: document.querySelector('#password').value,\r\n                    password_confirm: document.querySelector('#password_confirm').value,\r\n                })}\r\n            \u003e\r\n                \u003cinput name=\"username\" id=\"username\" placeholder=\"Username\" /\u003e\r\n                \u003cinput name=\"email\" id=\"email\" placeholder=\"Email\" /\u003e\r\n                \u003cinput name=\"password\" id=\"password\" type=\"password\" /\u003e\r\n                \u003cinput name=\"password_confirm\" id=\"password_confirm\" type=\"password\" /\u003e\r\n                \u003cbutton type=\"submit\" value=\"Sign up\"/\u003e\r\n            \u003c/form\u003e\r\n        )\r\n    }\r\n)\r\n```\r\n\r\nAs you can see, the usage of `withApi` is really simple - it only needs two parameters, and it passes down two new props - `apiState` and `apiRequest`. It's interface can be extended via optional arguments later. \r\n\r\nif we want to do something to the data before sending it to the server, like validate or transform it, we can use a higher-order component again. I've done it in `RegisterForm` to demonstrate how to implement non-standard cases while still reaping the beneifts of functional composition.\r\n\r\nThe code above can be further improved by moving code related to API request state into a separate component, but it's out of scope of this post.\r\n\r\n## Conclussion\r\n\r\nThis post is meant to be the last in the series about functional programming in React. I wrote it to explain the concepts to a relatively inexperienced developer, or someone who is coming from an object-oriented language like Java. I believe that I gave a good overview - from showing how functional programming is native to JavaScript to creating a reusable higher-order component.\r\n\r\nI don't think that FP is necessarily superior to object-oriented approach, but it makes a lot of sense to me in context of React. React [documentation](https://reactjs.org/docs/composition-vs-inheritance.html) mentions FP a lot, and core team members have [expressed preference for it](https://twitter.com/dan_abramov/status/752643494972383232). \r\n\r\nMy experience tells me that functional programming works well in a very big codebase that is shared across different product teams. Working with the functional code was good developer experience, it fascilitated a lot of code reuse and encouraged engineers to have good test coverage of reused code. FP became my favorite paradigm, and I have learned to apply it in other languages like Python and Go.\r\n\r\n## Useful links\r\n\r\n- [SOLID: The next step is functional](https://blog.ploeh.dk/2014/03/10/solid-the-next-step-is-functional/) - an article about the virtues of functional programming."},"__N_SSG":true},"page":"/blog/[slug]","query":{"slug":"reusable_hocs"},"buildId":"5HFLk1lVkhr6pmdWq9SEa","nextExport":false,"isFallback":false,"gsp":true}</script><script nomodule="" src="/_next/static/runtime/polyfills-d2ea1cc2739f90a3ff9c.js"></script><script async="" data-next-page="/_app" src="/_next/static/5HFLk1lVkhr6pmdWq9SEa/pages/_app.js"></script><script async="" data-next-page="/blog/[slug]" src="/_next/static/5HFLk1lVkhr6pmdWq9SEa/pages/blog/%5Bslug%5D.js"></script><script src="/_next/static/runtime/webpack-099a652a84207c43d340.js" async=""></script><script src="/_next/static/chunks/framework.619a4f70c1d4d3a29cbc.js" async=""></script><script src="/_next/static/chunks/commons.dd1d4337766320e3f3cd.js" async=""></script><script src="/_next/static/chunks/fde76e73e888c82a5daf01e132015384f0cd3d06.06fc960a10b812484c42.js" async=""></script><script src="/_next/static/runtime/main-4e8887e0577ac493b676.js" async=""></script><script src="/_next/static/chunks/9f96d65d.1337245caf768c94bbd9.js" async=""></script><script src="/_next/static/chunks/0ff34f855579ccbc49fb9fbff5971e037b34ab7f.bb40aa3f935ffd175372.js" async=""></script><script src="/_next/static/chunks/ba8ec81c0d15113a39d8f927686df0996bb5c7e2.60775f4e3f4a97510535.js" async=""></script><script src="/_next/static/chunks/487d4b9ae112fee708658936ad5012dbc925c095.094ce1d26a41e37f5194.js" async=""></script><script src="/_next/static/5HFLk1lVkhr6pmdWq9SEa/_buildManifest.js" async=""></script><script src="/_next/static/5HFLk1lVkhr6pmdWq9SEa/_ssgManifest.js" async=""></script></body></html>